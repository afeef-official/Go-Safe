<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#1B5E20">
    <meta name="description" content="GoSafe - Your trusted companion for a safe journey in Kerala. Navigate Kerala with confidence. Access emergency contacts, a handy phrasebook, and vital safety tips.">
    <meta name="keywords" content="GoSafe, Kerala, tourism, safety, travel, Malayalam, emergency, tourist guide, NSS College, Palakkad">
    <meta name="author" content="GoSafe">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="data:application/json,{&quot;name&quot;:&quot;GoSafe - Kerala Tourist Safety Companion&quot;,&quot;short_name&quot;:&quot;GoSafe&quot;,&quot;description&quot;:&quot;Your trusted companion for a safe journey in Kerala&quot;,&quot;start_url&quot;:&quot;/&quot;,&quot;display&quot;:&quot;standalone&quot;,&quot;background_color&quot;:&quot;#1B5E20&quot;,&quot;theme_color&quot;:&quot;#1B5E20&quot;,&quot;icons&quot;:[{&quot;src&quot;:&quot;data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDE5MiAxOTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTkyIiByeD0iMjQiIGZpbGw9IiMxQjVFMjAiLz4KPHN2ZyB4PSI0OCIgeT0iNDgiIHdpZHRoPSI5NiIgaGVpZ2h0PSI5NiIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+CjxwYXRoIGQ9Ik0xMiAyTDEzLjA5IDguMjZMMjAgOUwxMy4wOSAxNS43NEwxMiAyMkwxMC45MSAxNS43NEw0IDlMMTAuOTEgOC4yNkwxMiAyWiIvPgo8L3N2Zz4KPC9zdmc+&quot;,&quot;sizes&quot;:&quot;192x192&quot;,&quot;type&quot;:&quot;image/svg+xml&quot;}]}">
    
    <!-- PWA Icons -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiByeD0iNCIgZmlsbD0iIzFCNUUyMCIvPgo8c3ZnIHg9IjgiIHk9IjgiIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+CjxwYXRoIGQ9Ik0xMiAyTDEzLjA5IDguMjZMMjAgOUwxMy4wOSAxNS43NEwxMiAyMkwxMC45MSAxNS43NEw0IDlMMTAuOTEgOC4yNkwxMiAyWiIvPgo8L3N2Zz4KPC9zdmc+">
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTgwIiBoZWlnaHQ9IjE4MCIgdmlld0JveD0iMCAwIDE4MCAxODAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxODAiIGhlaWdodD0iMTgwIiByeD0iMjIiIGZpbGw9IiMxQjVFMjAiLz4KPHN2ZyB4PSI0NSIgeT0iNDUiIHdpZHRoPSI5MCIgaGVpZ2h0PSI5MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+CjxwYXRoIGQ9Ik0xMiAyTDEzLjA5IDguMjZMMjAgOUwxMy4wOSAxNS43NEwxMiAyMkwxMC45MSAxNS43NEw0IDlMMTAuOTEgOC4yNkwxMiAyWiIvPgo8L3N2Zz4KPC9zdmc+">
    
    <title>GoSafe - Kerala Tourist Safety Companion</title>
    <!-- Using system fonts for better performance and open source approach -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Minimal Kerala Tourist Safety App */

/* Reset and Base Styles */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Inter', 'Noto Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: #333;
  line-height: 1.5;
  margin: 0;
  padding: 0;
  min-height: 100vh;
}

/* App Layout */
#app {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

.app-header {
  background: linear-gradient(135deg, #ff6b6b, #ffa726);
  color: white;
  padding: 1.5rem;
  text-align: center;
  box-shadow: 0 4px 20px rgba(0,0,0,0.1);
  position: relative;
  overflow: hidden;
}

.app-header::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
  animation: shimmer 3s infinite;
}

@keyframes shimmer {
  0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
  100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
}

.logo-container {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 1rem;
  position: relative;
  z-index: 1;
  width: 100%;
}

.logo-shield {
  background: white;
  border-radius: 50%;
  padding: 0.5rem;
  box-shadow: 0 4px 15px rgba(0,0,0,0.2);
  display: flex;
  align-items: center;
  justify-content: center;
}

.logo-text h1 {
  font-size: 1.8rem;
  font-weight: 700;
  margin: 0;
  color: white;
  text-shadow: 0 2px 4px rgba(0,0,0,0.2);
  line-height: 1.2;
}

.logo-text p {
  font-size: 0.9rem;
  margin: 0;
  color: rgba(255,255,255,0.9);
  text-shadow: 0 1px 2px rgba(0,0,0,0.2);
  font-weight: 400;
}

.app-main {
  flex: 1;
  padding: 1rem;
  padding-bottom: 70px;
}

/* Cards */
.card {
  background: rgba(255, 255, 255, 0.95);
  border-radius: 16px;
  padding: 1.25rem;
  margin-bottom: 1rem;
  border: none;
  box-shadow: 0 8px 32px rgba(0,0,0,0.1);
  backdrop-filter: blur(10px);
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #feca57);
  background-size: 300% 100%;
  animation: gradientShift 3s ease infinite;
}

@keyframes gradientShift {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

.card:hover {
  transform: translateY(-5px);
  box-shadow: 0 12px 40px rgba(0,0,0,0.15);
}

.card h1 {
  font-size: 1.5rem;
  font-weight: 600;
  color: #333;
  margin-bottom: 0.5rem;
}

.card h2 {
  font-size: 1.25rem;
  font-weight: 500;
  color: #495057;
  margin-bottom: 0.75rem;
}

.card h3 {
  font-size: 1.1rem;
  font-weight: 500;
  color: #495057;
  margin-bottom: 0.5rem;
}

.card p {
  margin-bottom: 0.75rem;
  color: #6c757d;
  font-size: 0.9rem;
}

.card ul, .card ol {
  padding-left: 1.25rem;
  margin-bottom: 0.75rem;
}

.card li {
  margin-bottom: 0.25rem;
  font-size: 0.9rem;
  color: #6c757d;
}

/* Typography */
h1, h2, h3, h4, h5, h6 {
  color: #333;
  margin-bottom: 0.5rem;
}

/* Buttons */
.btn-primary {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
  padding: 0.75rem 1.5rem;
  border-radius: 25px;
  font-size: 0.9rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
  position: relative;
  overflow: hidden;
}

.btn-primary::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
  transition: left 0.5s;
}

.btn-primary:hover::before {
  left: 100%;
}

.btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
}

.btn-secondary {
  background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
  color: #8b4513;
  border: none;
  padding: 0.75rem 1.5rem;
  border-radius: 25px;
  font-size: 0.9rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 15px rgba(252, 182, 159, 0.3);
}

.btn-secondary:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(252, 182, 159, 0.4);
  background: linear-gradient(135deg, #fcb69f 0%, #ffecd2 100%);
}

.btn-emergency {
  background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
  color: white;
  border: none;
  padding: 0.75rem 1.5rem;
  border-radius: 25px;
  font-size: 0.9rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0% { box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3); }
  50% { box-shadow: 0 4px 25px rgba(255, 107, 107, 0.6); }
  100% { box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3); }
}

.btn-emergency:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(255, 107, 107, 0.5);
  animation: none;
}

.btn-warning {
  background: linear-gradient(135deg, #feca57 0%, #ff9ff3 100%);
  color: #8b4513;
  border: none;
  padding: 0.75rem 1.5rem;
  border-radius: 25px;
  font-size: 0.9rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 15px rgba(254, 202, 87, 0.3);
}

.btn-warning:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(254, 202, 87, 0.4);
  background: linear-gradient(135deg, #ff9ff3 0%, #feca57 100%);
}

.btn-large {
  width: 100%;
  padding: 0.75rem;
  font-size: 1rem;
}

/* Quick Actions */
.quick-actions {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 1rem;
}

.action-btn {
  display: flex;
  align-items: center;
  padding: 1rem;
  border: none;
  border-radius: 20px;
  cursor: pointer;
  transition: all 0.3s ease;
  text-align: left;
  background: rgba(255, 255, 255, 0.9);
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  position: relative;
  overflow: hidden;
}

.action-btn::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
  transform: translateX(-100%);
  transition: transform 0.6s;
}

.action-btn:hover::before {
  transform: translateX(100%);
}

.action-btn .icon {
  font-size: 2rem;
  margin-right: 1rem;
  transition: transform 0.3s ease;
}

.action-btn:hover .icon {
  transform: scale(1.2) rotate(5deg);
}

.action-btn div {
  flex: 1;
  position: relative;
  z-index: 1;
}

.action-btn strong {
  display: block;
  font-size: 1rem;
  margin-bottom: 0.25rem;
  color: #333;
  font-weight: 600;
}

.action-btn small {
  display: block;
  color: #6c757d;
  font-size: 0.85rem;
}

.action-btn.emergency {
  background: linear-gradient(135deg, #ff6b6b, #ee5a24);
  color: white;
  box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
}

.action-btn.safety {
  background: linear-gradient(135deg, #4ecdc4, #44a08d);
  color: white;
  box-shadow: 0 4px 15px rgba(78, 205, 196, 0.3);
}

.action-btn.phrasebook {
  background: linear-gradient(135deg, #667eea, #764ba2);
  color: white;
  box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
}

.action-btn.directory {
  background: linear-gradient(135deg, #feca57, #ff9ff3);
  color: #8b4513;
  box-shadow: 0 4px 15px rgba(254, 202, 87, 0.3);
}

.action-btn.location {
  background: linear-gradient(135deg, #fd7e14, #f093fb);
  color: white;
  box-shadow: 0 4px 15px rgba(253, 126, 20, 0.3);
}

.action-btn.police {
  background: linear-gradient(135deg, #ff6b6b, #ee5a24);
  color: white;
  box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
}

.action-btn.medical {
  background: linear-gradient(135deg, #4ecdc4, #44a08d);
  color: white;
  box-shadow: 0 4px 15px rgba(78, 205, 196, 0.3);
}

.action-btn.fire {
  background: linear-gradient(135deg, #fd7e14, #f093fb);
  color: white;
  box-shadow: 0 4px 15px rgba(253, 126, 20, 0.3);
}

.action-btn.etiquette {
  background: linear-gradient(135deg, #a29bfe, #6c5ce7);
  color: white;
  box-shadow: 0 4px 15px rgba(162, 155, 254, 0.3);
}

.action-btn:hover {
  transform: translateY(-5px) scale(1.02);
  box-shadow: 0 8px 25px rgba(0,0,0,0.2);
}

/* Emergency Numbers */
.emergency-numbers {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: 0.75rem;
}

.emergency-chip {
  background: linear-gradient(135deg, #ff6b6b, #ee5a24);
  color: white;
  padding: 0.75rem 1rem;
  border-radius: 25px;
  font-weight: 600;
  text-align: center;
  font-size: 0.85rem;
  box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.emergency-chip::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
  transition: left 0.5s;
}

.emergency-chip:hover::before {
  left: 100%;
}

.emergency-chip:hover {
  transform: translateY(-2px) scale(1.05);
  box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
}

.emergency-chip.police {
  background: linear-gradient(135deg, #ff6b6b, #ee5a24);
}

.emergency-chip.medical {
  background: linear-gradient(135deg, #4ecdc4, #44a08d);
}

.emergency-chip.fire {
  background: linear-gradient(135deg, #fd7e14, #f093fb);
}

.emergency-chip.tourist {
  background: linear-gradient(135deg, #667eea, #764ba2);
}

/* Search */
.search-container {
  margin-bottom: 0.75rem;
}

.search-input {
  width: 100%;
  padding: 0.5rem;
  border: 1px solid #dee2e6;
  border-radius: 6px;
  font-size: 0.9rem;
  transition: border-color 0.2s;
}

.search-input:focus {
  outline: none;
  border-color: #007bff;
}

/* Category Tabs */
.category-tabs {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  margin-bottom: 0.75rem;
}

.category-tab {
  background-color: #f8f9fa;
  color: #6c757d;
  border: 1px solid #dee2e6;
  padding: 0.4rem 0.75rem;
  border-radius: 6px;
  font-size: 0.8rem;
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
}

.category-tab.active {
  background-color: #007bff;
  color: white;
  border-color: #007bff;
}

.category-tab:hover {
  background-color: #007bff;
  color: white;
  border-color: #007bff;
}

/* Phrase Cards */
.phrase-card {
  background-color: #f8f9fa;
  padding: 0.75rem;
  border-radius: 6px;
  margin-bottom: 0.5rem;
  border: 1px solid #e9ecef;
}

.malayalam-text {
  font-size: 1rem;
  font-weight: 600;
  color: #333;
  margin-bottom: 0.25rem;
}

.english-text {
  font-size: 0.9rem;
  color: #495057;
  font-style: italic;
  margin-bottom: 0.25rem;
}

.pronunciation-text {
  font-size: 0.8rem;
  color: #6c757d;
}

/* Contact Cards */
.contact-card {
  background: white;
  padding: 0.75rem;
  border-radius: 6px;
  margin-bottom: 0.5rem;
  border: 1px solid #e9ecef;
  border-left: 3px solid #007bff;
}

.contact-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 0.5rem;
}

.contact-info {
  display: flex;
  align-items: center;
}

.status-dot {
  width: 8px;
  height: 8px;
  border-radius: 50%;
  margin-right: 0.5rem;
}

.status-dot.online {
  background-color: #28a745;
}

.status-dot.offline {
  background-color: #6c757d;
}

.rating {
  color: #ffc107;
  font-weight: 500;
  font-size: 0.8rem;
}

.contact-detail {
  font-size: 0.8rem;
  margin-bottom: 0.25rem;
  color: #6c757d;
}

.contact-actions {
  display: flex;
  gap: 0.5rem;
  margin-top: 0.5rem;
}

.contact-actions button {
  flex: 1;
  padding: 0.4rem;
  font-size: 0.8rem;
}

/* Emergency Contacts */
.emergency-contact {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.75rem;
  border-radius: 6px;
  margin-bottom: 0.5rem;
  border: 1px solid #e9ecef;
  border-left: 3px solid #dc3545;
  background: white;
}

.emergency-info {
  flex: 1;
}

.emergency-info strong {
  display: block;
  margin-bottom: 0.25rem;
  font-size: 0.9rem;
}

.emergency-info p {
  margin-bottom: 0.5rem;
  font-size: 0.8rem;
  color: #6c757d;
}

.emergency-number {
  font-size: 1rem;
  font-weight: 600;
  color: #dc3545;
}

/* Forms */
.form-group {
  margin-bottom: 0.75rem;
}

.form-group label {
  display: block;
  margin-bottom: 0.25rem;
  font-weight: 500;
  color: #333;
  font-size: 0.9rem;
}

.form-group input,
.form-group textarea {
  width: 100%;
  padding: 0.5rem;
  border: 1px solid #dee2e6;
  border-radius: 6px;
  font-size: 0.9rem;
  transition: border-color 0.2s;
}

.form-group input:focus,
.form-group textarea:focus {
  outline: none;
  border-color: #007bff;
}

.form-group textarea {
  resize: vertical;
  min-height: 60px;
}

/* Check-in Status */
.checkin-status {
  text-align: center;
}

.checkin-icon {
  font-size: 3rem;
  margin-bottom: 0.75rem;
}

.checkin-details {
  margin-bottom: 1rem;
}

.checkin-details p {
  margin-bottom: 0.25rem;
  font-size: 0.9rem;
}

.checkin-actions {
  display: flex;
  gap: 0.75rem;
}

.checkin-actions button {
  flex: 1;
  padding: 0.75rem;
  font-size: 0.9rem;
}

/* Bottom Navigation */
.bottom-nav {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  background: rgba(255, 255, 255, 0.95);
  backdrop-filter: blur(10px);
  display: flex;
  justify-content: space-around;
  padding: 0.75rem 0;
  border-top: 1px solid rgba(0,0,0,0.1);
  z-index: 1000;
  box-shadow: 0 -4px 20px rgba(0,0,0,0.1);
}

.nav-btn {
  background: none;
  border: none;
  color: #6c757d;
  cursor: pointer;
  padding: 0.75rem;
  transition: all 0.3s ease;
  display: flex;
  flex-direction: column;
  align-items: center;
  border-radius: 15px;
  position: relative;
}

.nav-btn.active {
  color: #667eea;
  background: rgba(102, 126, 234, 0.1);
  transform: scale(1.1);
}

.nav-btn:hover {
  color: #667eea;
  background: rgba(102, 126, 234, 0.05);
  transform: scale(1.05);
}

.nav-icon {
  font-size: 1.3rem;
  margin-bottom: 0.25rem;
  transition: transform 0.3s ease;
}

.nav-btn:hover .nav-icon {
  transform: scale(1.2);
}

.nav-label {
  font-size: 0.75rem;
  font-weight: 600;
}

/* Responsive Design */
@media (max-width: 768px) {
  .app-main {
    padding: 0.75rem;
  }
  
  .card {
    padding: 0.75rem;
  }
  
  .quick-actions {
    grid-template-columns: 1fr;
  }
  
  .emergency-quick-actions {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .emergency-numbers {
    grid-template-columns: repeat(2, 1fr);
  }
  
  .checkin-actions {
    flex-direction: column;
  }
  
  .contact-actions {
    flex-direction: column;
  }
  
  .emergency-contact {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.75rem;
  }
  
  .emergency-contact button {
    width: 100%;
  }
}

@media (max-width: 480px) {
  .logo-container {
    flex-direction: column;
    gap: 0.5rem;
    text-align: center;
  }
  
  .logo-text h1 {
    font-size: 1.4rem;
  }
  
  .logo-text p {
    font-size: 0.8rem;
  }
  
  .card h1 {
    font-size: 1.25rem;
  }
  
  .card h2 {
    font-size: 1.1rem;
  }
  
  .emergency-quick-actions {
    grid-template-columns: 1fr;
  }
  
  .emergency-numbers {
    grid-template-columns: 1fr;
  }
  
  .nav-label {
    font-size: 0.65rem;
  }
}

/* Focus styles for keyboard navigation */
button:focus,
input:focus,
textarea:focus {
  outline: 2px solid #007bff;
  outline-offset: 1px;
}

/* Auto Rickshaw Fare Calculator Styles */
.fare-result {
  margin-top: 0.75rem;
  padding: 0.75rem;
  background-color: #f8f9fa;
  border-radius: 6px;
  border: 1px solid #e9ecef;
}

.fare-result h3 {
  color: #333;
  margin-bottom: 0.75rem;
  font-size: 1rem;
}

.fare-details {
  margin-bottom: 0.75rem;
}

.fare-details p {
  margin-bottom: 0.25rem;
  color: #495057;
  font-size: 0.8rem;
}

.total-fare {
  background-color: #007bff;
  color: white;
  padding: 0.75rem;
  border-radius: 6px;
  text-align: center;
  margin-top: 0.75rem;
  font-size: 1rem;
  font-weight: 600;
}

.fare-note {
  margin-top: 0.75rem;
  padding: 0.5rem;
  background-color: #fff3cd;
  border-radius: 4px;
  border: 1px solid #ffeaa7;
}

.fare-note small {
  color: #856404;
  font-style: italic;
  font-size: 0.75rem;
}

.fare-structure {
  display: flex;
  flex-direction: column;
  gap: 0.75rem;
}

.fare-item {
  display: flex;
  align-items: center;
  padding: 0.75rem;
  background-color: #f8f9fa;
  border-radius: 6px;
  border: 1px solid #e9ecef;
}

.fare-label {
  font-weight: 500;
  color: #333;
  min-width: 100px;
  font-size: 0.9rem;
}

.fare-value {
  font-weight: 600;
  color: #007bff;
  font-size: 1rem;
  margin: 0 0.75rem;
}

.fare-desc {
  color: #6c757d;
  font-size: 0.8rem;
}

.route-examples {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.route-item {
  padding: 0.5rem;
  background-color: #f8f9fa;
  border-radius: 4px;
  border: 1px solid #e9ecef;
  color: #495057;
  font-size: 0.8rem;
}

.route-item strong {
  color: #333;
}

/* Responsive adjustments for fare calculator */
@media (max-width: 768px) {
  .fare-item {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.25rem;
  }
  
  .fare-label {
    min-width: auto;
  }
  
  .fare-value {
    margin: 0;
  }
}

/* Interactive Map Styles */
.map-container {
  margin: 1rem 0;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  position: relative;
}

.openstreetmap-container {
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 4px 15px rgba(0,0,0,0.1);
}

.interactive-map {
  height: 300px;
  background: linear-gradient(135deg, #4ecdc4, #44a08d);
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 12px;
  overflow: hidden;
}

.map-placeholder {
  text-align: center;
  color: white;
  z-index: 2;
  position: relative;
}

.map-icon {
  font-size: 4rem;
  margin-bottom: 1rem;
  animation: bounce 2s infinite;
}

@keyframes bounce {
  0%, 20%, 50%, 80%, 100% {
    transform: translateY(0);
  }
  40% {
    transform: translateY(-10px);
  }
  60% {
    transform: translateY(-5px);
  }
}

.map-placeholder h3 {
  color: white;
  margin-bottom: 0.5rem;
  font-size: 1.5rem;
  font-weight: 600;
}

.map-placeholder p {
  color: rgba(255, 255, 255, 0.9);
  margin-bottom: 1.5rem;
  font-size: 1rem;
}

.map-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(135deg, rgba(78, 205, 196, 0.9), rgba(68, 160, 141, 0.9));
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1;
}

.map-content {
  position: relative;
  z-index: 2;
  text-align: center;
  color: white;
}

.user-location {
  position: absolute;
  width: 20px;
  height: 20px;
  background: #ff6b6b;
  border: 3px solid white;
  border-radius: 50%;
  box-shadow: 0 0 0 3px rgba(255, 107, 107, 0.3);
  animation: pulse 2s infinite;
  z-index: 3;
}

.nearby-marker {
  position: absolute;
  width: 12px;
  height: 12px;
  background: #4ecdc4;
  border: 2px solid white;
  border-radius: 50%;
  box-shadow: 0 2px 8px rgba(0,0,0,0.2);
  z-index: 2;
  cursor: pointer;
  transition: all 0.3s ease;
}

.nearby-marker:hover {
  transform: scale(1.5);
  background: #feca57;
}

.nearby-marker.emergency {
  background: #ff6b6b;
  animation: pulse 2s infinite;
}

.nearby-marker.hospital {
  background: #4ecdc4;
}

.nearby-marker.police {
  background: #667eea;
}

.nearby-marker.restaurant {
  background: #feca57;
}

.nearby-marker.hotel {
  background: #ff9ff3;
}

.nearby-marker.attraction {
  background: #96ceb4;
}

.nearby-places {
  margin-top: 1rem;
  padding: 1rem;
  background: rgba(255, 255, 255, 0.9);
  border-radius: 12px;
  backdrop-filter: blur(10px);
}

.nearby-places h3 {
  color: #333;
  margin-bottom: 1rem;
  font-size: 1.2rem;
  font-weight: 600;
}

.places-list {
  display: grid;
  gap: 0.75rem;
}

.place-item {
  display: flex;
  align-items: center;
  padding: 0.75rem;
  background: white;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  transition: all 0.3s ease;
  cursor: pointer;
}

.place-actions {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.place-item:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 15px rgba(0,0,0,0.15);
}

.place-icon {
  font-size: 1.5rem;
  margin-right: 0.75rem;
  width: 30px;
  text-align: center;
}

.place-info {
  flex: 1;
}

.place-name {
  font-weight: 600;
  color: #333;
  margin-bottom: 0.25rem;
  font-size: 0.9rem;
}

.place-distance {
  color: #6c757d;
  font-size: 0.8rem;
}

.place-type {
  background: linear-gradient(135deg, #4ecdc4, #44a08d);
  color: white;
  padding: 0.25rem 0.5rem;
  border-radius: 12px;
  font-size: 0.7rem;
  font-weight: 600;
  text-transform: uppercase;
}

.place-type.emergency {
  background: linear-gradient(135deg, #ff6b6b, #ee5a24);
}

.place-type.hospital {
  background: linear-gradient(135deg, #4ecdc4, #44a08d);
}

.place-type.police {
  background: linear-gradient(135deg, #667eea, #764ba2);
}

.place-type.restaurant {
  background: linear-gradient(135deg, #feca57, #ff9ff3);
}

.place-type.hotel {
  background: linear-gradient(135deg, #ff9ff3, #f093fb);
}

.place-type.attraction {
  background: linear-gradient(135deg, #96ceb4, #4ecdc4);
}

.map-controls {
  position: absolute;
  top: 10px;
  right: 10px;
  z-index: 4;
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
  background: rgba(255, 255, 255, 0.9);
  padding: 0.5rem;
  border-radius: 8px;
  backdrop-filter: blur(10px);
}

.map-control-btn {
  background: rgba(255, 255, 255, 0.9);
  border: none;
  border-radius: 8px;
  padding: 0.5rem;
  cursor: pointer;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  transition: all 0.3s ease;
  font-size: 1.2rem;
}

.map-control-btn:hover {
  background: white;
  transform: scale(1.1);
}

/* Responsive Map */
@media (max-width: 768px) {
  .interactive-map {
    height: 250px;
  }
  
  .map-icon {
    font-size: 3rem;
  }
  
  .map-placeholder h3 {
    font-size: 1.25rem;
  }
  
  .places-list {
    grid-template-columns: 1fr;
  }
}

/* Weather Widget Styles */
.weather-widget {
  background: linear-gradient(135deg, #74b9ff, #0984e3);
  color: white;
  padding: 1rem;
  border-radius: 12px;
  margin-bottom: 1rem;
  box-shadow: 0 4px 15px rgba(116, 185, 255, 0.3);
  position: relative;
  overflow: hidden;
}

.weather-widget::before {
  content: '';
  position: absolute;
  top: -50%;
  right: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
  animation: weatherGlow 4s ease-in-out infinite;
}

@keyframes weatherGlow {
  0%, 100% { transform: scale(1) rotate(0deg); }
  50% { transform: scale(1.1) rotate(180deg); }
}

.weather-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 0.75rem;
  position: relative;
  z-index: 1;
}

.weather-location {
  font-size: 1.1rem;
  font-weight: 600;
}

.weather-temp {
  font-size: 2rem;
  font-weight: 700;
}

.weather-details {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 0.75rem;
  position: relative;
  z-index: 1;
}

.weather-detail {
  text-align: center;
}

.weather-detail-label {
  font-size: 0.8rem;
  opacity: 0.9;
  margin-bottom: 0.25rem;
}

.weather-detail-value {
  font-size: 1rem;
  font-weight: 600;
}

/* Offline Indicator */
.offline-indicator {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  background: #ff6b6b;
  color: white;
  text-align: center;
  padding: 0.5rem;
  font-size: 0.9rem;
  font-weight: 600;
  z-index: 9999;
  transform: translateY(-100%);
  transition: transform 0.3s ease;
}

.offline-indicator.show {
  transform: translateY(0);
}

/* Accessibility Features */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

.high-contrast {
  filter: contrast(150%) brightness(120%);
}

.large-text {
  font-size: 1.2em;
  line-height: 1.6;
}

/* Translation Widget */
.translation-widget {
  background: linear-gradient(135deg, #a29bfe, #6c5ce7);
  color: white;
  padding: 1rem;
  border-radius: 12px;
  margin-bottom: 1rem;
  box-shadow: 0 4px 15px rgba(162, 155, 254, 0.3);
}

.translation-input {
  width: 100%;
  padding: 0.75rem;
  border: none;
  border-radius: 8px;
  font-size: 1rem;
  margin-bottom: 0.75rem;
  background: rgba(255, 255, 255, 0.9);
  color: #333;
}

.translation-output {
  background: rgba(255, 255, 255, 0.1);
  padding: 0.75rem;
  border-radius: 8px;
  min-height: 60px;
  font-size: 1rem;
  line-height: 1.5;
}

.translation-languages {
  display: flex;
  gap: 0.5rem;
  margin-bottom: 0.75rem;
}

.translation-lang {
  background: rgba(255, 255, 255, 0.2);
  border: none;
  color: white;
  padding: 0.5rem 1rem;
  border-radius: 20px;
  font-size: 0.9rem;
  cursor: pointer;
  transition: all 0.3s ease;
}

.translation-lang.active {
  background: rgba(255, 255, 255, 0.3);
  font-weight: 600;
}

/* Voice Features */
.voice-controls {
  display: flex;
  gap: 0.5rem;
  margin-top: 0.75rem;
}

.voice-btn {
  background: rgba(255, 255, 255, 0.2);
  border: none;
  color: white;
  padding: 0.5rem;
  border-radius: 50%;
  width: 40px;
  height: 40px;
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.2rem;
}

.voice-btn:hover {
  background: rgba(255, 255, 255, 0.3);
  transform: scale(1.1);
}

.voice-btn.recording {
  background: #ff6b6b;
  animation: pulse 1s infinite;
}

/* Emergency Quick Actions */
.emergency-quick-actions {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 0.75rem;
  margin-bottom: 1rem;
}

.emergency-quick-btn {
  background: linear-gradient(135deg, #ff6b6b, #ee5a24);
  color: white;
  border: none;
  padding: 1rem;
  border-radius: 12px;
  font-size: 0.9rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.5rem;
  box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
}

.emergency-quick-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(255, 107, 107, 0.4);
}

.emergency-quick-btn .icon {
  font-size: 1.5rem;
}

/* Accessibility Controls */
.accessibility-controls {
  position: fixed;
  top: 10px;
  right: 10px;
  z-index: 1000;
  display: flex;
  flex-direction: column;
  gap: 0.5rem;
}

.accessibility-btn {
  background: rgba(0, 0, 0, 0.7);
  color: white;
  border: none;
  padding: 0.5rem;
  border-radius: 50%;
  width: 40px;
  height: 40px;
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1rem;
}

.accessibility-btn:hover {
  background: rgba(0, 0, 0, 0.9);
  transform: scale(1.1);
}

/* Dark Mode */
.dark-mode {
  background: linear-gradient(135deg, #2d3436 0%, #636e72 100%);
  color: #ddd;
}

.dark-mode .card {
  background: rgba(45, 52, 54, 0.95);
  color: #ddd;
}

.dark-mode .card h1,
.dark-mode .card h2,
.dark-mode .card h3 {
  color: #fff;
}

/* Loading States */
.loading {
  display: inline-block;
  width: 20px;
  height: 20px;
  border: 3px solid rgba(255, 255, 255, 0.3);
  border-radius: 50%;
  border-top-color: #fff;
  animation: spin 1s ease-in-out infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

/* Notification Styles */
.notification {
  position: fixed;
  top: 20px;
  right: 20px;
  background: #4ecdc4;
  color: white;
  padding: 1rem;
  border-radius: 8px;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
  z-index: 10000;
  transform: translateX(100%);
  transition: transform 0.3s ease;
}

.notification.show {
  transform: translateX(0);
}

.notification.error {
  background: #ff6b6b;
}

.notification.success {
  background: #4ecdc4;
}

.notification.warning {
  background: #feca57;
  color: #333;
}

/* Cultural Etiquette & Scams Guide Styles */
.etiquette-categories {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  margin-bottom: 1rem;
}

.etiquette-category {
  background: linear-gradient(135deg, #a29bfe, #6c5ce7);
  color: white;
  border: none;
  padding: 0.75rem 1rem;
  border-radius: 25px;
  font-size: 0.9rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 15px rgba(162, 155, 254, 0.3);
}

.etiquette-category.active {
  background: linear-gradient(135deg, #6c5ce7, #a29bfe);
  transform: scale(1.05);
  box-shadow: 0 6px 20px rgba(162, 155, 254, 0.4);
}

.etiquette-category:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(162, 155, 254, 0.4);
}

.etiquette-content {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1rem;
  margin-top: 1rem;
}

.etiquette-section {
  background: rgba(255, 255, 255, 0.95);
  border-radius: 12px;
  padding: 1.25rem;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
  position: relative;
  overflow: hidden;
}

.etiquette-section::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg, #00b894, #00cec9);
  background-size: 300% 100%;
  animation: gradientShift 3s ease infinite;
}

.etiquette-section.dos::before {
  background: linear-gradient(90deg, #00b894, #00cec9);
}

.etiquette-section.donts::before {
  background: linear-gradient(90deg, #e17055, #d63031);
}

.etiquette-section h3 {
  color: #333;
  margin-bottom: 1rem;
  font-size: 1.2rem;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.etiquette-list {
  list-style: none;
  padding: 0;
  margin: 0;
}

.etiquette-list li {
  padding: 0.75rem;
  margin-bottom: 0.5rem;
  border-radius: 8px;
  font-size: 0.9rem;
  line-height: 1.5;
  position: relative;
  padding-left: 2.5rem;
  transition: all 0.3s ease;
}

.etiquette-list li::before {
  content: '';
  position: absolute;
  left: 0.75rem;
  top: 50%;
  transform: translateY(-50%);
  width: 8px;
  height: 8px;
  border-radius: 50%;
}

.dos .etiquette-list li {
  background: rgba(0, 184, 148, 0.1);
  border-left: 3px solid #00b894;
  color: #2d3436;
}

.dos .etiquette-list li::before {
  background: #00b894;
}

.donts .etiquette-list li {
  background: rgba(214, 48, 49, 0.1);
  border-left: 3px solid #d63031;
  color: #2d3436;
}

.donts .etiquette-list li::before {
  background: #d63031;
}

.etiquette-list li:hover {
  transform: translateX(5px);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.etiquette-icon {
  font-size: 1.5rem;
  margin-right: 0.5rem;
}

.etiquette-tips {
  background: linear-gradient(135deg, #74b9ff, #0984e3);
  color: white;
  padding: 1rem;
  border-radius: 12px;
  margin-bottom: 1rem;
  box-shadow: 0 4px 15px rgba(116, 185, 255, 0.3);
}

.etiquette-tips h3 {
  color: white;
  margin-bottom: 0.75rem;
  font-size: 1.1rem;
}

.etiquette-tips p {
  margin: 0;
  font-size: 0.9rem;
  line-height: 1.5;
  opacity: 0.9;
}

/* Common Scams Styles */
.common-scams {
  margin-top: 1rem;
}

.scam-item {
  background: rgba(255, 255, 255, 0.95);
  border-radius: 12px;
  padding: 1.25rem;
  margin-bottom: 1rem;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
  border-left: 4px solid #e17055;
  position: relative;
  overflow: hidden;
  transition: all 0.3s ease;
}

.scam-item:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
}

.scam-item::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg, #e17055, #d63031);
  background-size: 300% 100%;
  animation: gradientShift 3s ease infinite;
}

.scam-header {
  display: flex;
  align-items: center;
  margin-bottom: 1rem;
}

.scam-icon {
  font-size: 1.5rem;
  margin-right: 0.75rem;
  color: #e17055;
}

.scam-title {
  font-size: 1.1rem;
  font-weight: 600;
  color: #2d3436;
  margin: 0;
}

.scam-description {
  color: #636e72;
  font-size: 0.9rem;
  margin-bottom: 1rem;
  line-height: 1.5;
}

.scam-details {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 1rem;
  margin-bottom: 1rem;
}

.scam-detail {
  background: rgba(255, 255, 255, 0.7);
  padding: 0.75rem;
  border-radius: 8px;
  border-left: 3px solid #74b9ff;
}

.scam-detail h4 {
  font-size: 0.85rem;
  font-weight: 600;
  color: #2d3436;
  margin: 0 0 0.5rem 0;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.scam-detail p {
  font-size: 0.8rem;
  color: #636e72;
  margin: 0;
  line-height: 1.4;
}

.scam-actions {
  display: flex;
  gap: 0.5rem;
  margin-top: 1rem;
}

.scam-action-btn {
  background: linear-gradient(135deg, #e17055, #d63031);
  color: white;
  border: none;
  padding: 0.5rem 1rem;
  border-radius: 20px;
  font-size: 0.8rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 2px 8px rgba(225, 112, 85, 0.3);
}

.scam-action-btn:hover {
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(225, 112, 85, 0.4);
}

.scam-action-btn.secondary {
  background: linear-gradient(135deg, #74b9ff, #0984e3);
  box-shadow: 0 2px 8px rgba(116, 185, 255, 0.3);
}

.scam-action-btn.secondary:hover {
  box-shadow: 0 4px 12px rgba(116, 185, 255, 0.4);
}

.scam-warning {
  background: linear-gradient(135deg, #fdcb6e, #e17055);
  color: white;
  padding: 1rem;
  border-radius: 12px;
  margin-bottom: 1rem;
  box-shadow: 0 4px 15px rgba(253, 203, 110, 0.3);
}

.scam-warning h3 {
  color: white;
  margin-bottom: 0.75rem;
  font-size: 1.1rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.scam-warning p {
  margin: 0;
  font-size: 0.9rem;
  line-height: 1.5;
  opacity: 0.9;
}

/* Responsive Design for Etiquette */
@media (max-width: 768px) {
  .etiquette-content {
    grid-template-columns: 1fr;
  }
  
  .etiquette-categories {
    justify-content: center;
  }
  
  .etiquette-category {
    font-size: 0.8rem;
    padding: 0.6rem 0.8rem;
  }
  
  .scam-details {
    grid-template-columns: 1fr;
  }
  
  .scam-actions {
    flex-direction: column;
  }
  
  .scam-action-btn {
    width: 100%;
    text-align: center;
  }
}
    </style>
</head>
<body>
    <div id="app"></div>
    
    <script>
        /* PASTE ALL JAVASCRIPT CONTENT HERE */// Kerala Tourist Safety & Language App - Single File Version
// All components and functionality merged into one file

// Data
const phrases = {
  emergency: [
    { malayalam: "സഹായം!", english: "Help!", pronunciation: "Sahāyam!" },
    { malayalam: "എനിക്ക് സഹായം വേണം", english: "I need help", pronunciation: "Enikku sahāyam vēṇam" },
    { malayalam: "പോലീസ് വിളിക്കുക", english: "Call the police", pronunciation: "Pōlīs viḷikkuka" },
    { malayalam: "ആംബുലൻസ് വിളിക്കുക", english: "Call an ambulance", pronunciation: "Āmbulans viḷikkuka" },
    { malayalam: "എനിക്ക് മുറിവേറ്റു", english: "I am injured", pronunciation: "Enikku muṟivēṟṟu" }
  ],
  basic: [
    { malayalam: "നമസ്കാരം", english: "Hello", pronunciation: "Namaskāram" },
    { malayalam: "വിട", english: "Goodbye", pronunciation: "Viṭa" },
    { malayalam: "നന്ദി", english: "Thank you", pronunciation: "Nandi" },
    { malayalam: "ക്ഷമിക്കണം", english: "Sorry/Excuse me", pronunciation: "Kṣamikkaṇam" },
    { malayalam: "അതെ", english: "Yes", pronunciation: "Ate" },
    { malayalam: "അല്ല", english: "No", pronunciation: "Alla" }
  ],
  directions: [
    { malayalam: "എവിടെ?", english: "Where?", pronunciation: "Eviṭe?" },
    { malayalam: "ഇവിടെ", english: "Here", pronunciation: "Iviṭe" },
    { malayalam: "അവിടെ", english: "There", pronunciation: "Aviṭe" },
    { malayalam: "വലത്ത്", english: "Right", pronunciation: "Valat" },
    { malayalam: "ഇടത്ത്", english: "Left", pronunciation: "Iṭat" },
    { malayalam: "നേരെ", english: "Straight", pronunciation: "Nēre" }
  ],
  transport: [
    { malayalam: "ബസ് സ്റ്റോപ്പ് എവിടെ?", english: "Where is the bus stop?", pronunciation: "Bas stop eviṭe?" },
    { malayalam: "റെയിൽവേ സ്റ്റേഷൻ എവിടെ?", english: "Where is the railway station?", pronunciation: "Reyilvē stēṣan eviṭe?" },
    { malayalam: "എയർപോർട്ട് എവിടെ?", english: "Where is the airport?", pronunciation: "Eyrpōrṯ eviṭe?" },
    { malayalam: "ടാക്സി വിളിക്കുക", english: "Call a taxi", pronunciation: "Ṭāksi viḷikkuka" },
    { malayalam: "എത്ര ദൂരം?", english: "How far?", pronunciation: "Etra dūram?" }
  ],
  accommodation: [
    { malayalam: "ഹോട്ടൽ എവിടെ?", english: "Where is a hotel?", pronunciation: "Hōṭal eviṭe?" },
    { malayalam: "മുറി ലഭ്യമാണോ?", english: "Is a room available?", pronunciation: "Muṟi labhyamāṇō?" },
    { malayalam: "എത്ര രൂപ?", english: "How much?", pronunciation: "Etra rūpa?" },
    { malayalam: "വൈഫൈ ഉണ്ടോ?", english: "Is there WiFi?", pronunciation: "Vai fai uṇṭō?" },
    { malayalam: "ബ്രേക്ക്ഫാസ്റ്റ് ഉണ്ടോ?", english: "Is breakfast available?", pronunciation: "Brēk fasṯ uṇṭō?" }
  ],
  food: [
    { malayalam: "ഞാൻ വിശക്കുന്നു", english: "I am hungry", pronunciation: "Ñān viśakkunnu" },
    { malayalam: "റെസ്റ്റോറന്റ് എവിടെ?", english: "Where is a restaurant?", pronunciation: "Resṯōranṯ eviṭe?" },
    { malayalam: "മെനു കാണിക്കുക", english: "Show me the menu", pronunciation: "Menu kāṇikkuka" },
    { malayalam: "ജലം", english: "Water", pronunciation: "Jalam" },
    { malayalam: "ചായ", english: "Tea", pronunciation: "Cāya" },
    { malayalam: "കാപ്പി", english: "Coffee", pronunciation: "Kāppi" }
  ],
  shopping: [
    { malayalam: "ഷോപ്പ് എവിടെ?", english: "Where is a shop?", pronunciation: "Ṣōp eviṭe?" },
    { malayalam: "എത്ര രൂപ?", english: "How much?", pronunciation: "Etra rūpa?" },
    { malayalam: "വില കുറയ്ക്കുക", english: "Reduce the price", pronunciation: "Vila kuṟaykkuka" },
    { malayalam: "ബിൽ കൊടുക്കുക", english: "Give me the bill", pronunciation: "Bil koṭukkuka" },
    { malayalam: "ക്രെഡിറ്റ് കാർഡ് സ്വീകരിക്കുമോ?", english: "Do you accept credit cards?", pronunciation: "Krēḍiṯ kārḍ svīkarikkumō?" }
  ]
};

const contacts = {
  emergency: [
    { id: 1, name: "Police Emergency", number: "100", type: "emergency", description: "Kerala Police Emergency Response", available: true },
    { id: 2, name: "Medical Emergency", number: "108", type: "emergency", description: "Ambulance & Medical Emergency", available: true },
    { id: 3, name: "Fire Service", number: "101", type: "emergency", description: "Fire & Rescue Services", available: true },
    { id: 4, name: "Women Helpline", number: "1091", type: "emergency", description: "Women Safety Helpline", available: true },
    { id: 5, name: "Tourist Helpline", number: "1363", type: "emergency", description: "Kerala Tourism Helpline", available: true }
  ],
  tourGuides: [
    { id: 1, name: "Rajesh Kumar", phone: "+91 98765 43210", email: "rajesh.kumar@keralatours.com", languages: ["Malayalam", "English", "Hindi"], experience: "8 years", rating: 4.8, specialties: ["Palakkad Fort", "Malampuzha Dam", "Cultural Tours"], verified: true, location: "Palakkad", available: true },
    { id: 2, name: "Priya Menon", phone: "+91 98765 43211", email: "priya.menon@keralatours.com", languages: ["Malayalam", "English", "French"], experience: "6 years", rating: 4.9, specialties: ["Silent Valley", "Ayurveda", "Adventure Tours"], verified: true, location: "Palakkad", available: true },
    { id: 3, name: "Suresh Nair", phone: "+91 98765 43212", email: "suresh.nair@keralatours.com", languages: ["Malayalam", "English", "Tamil"], experience: "10 years", rating: 4.7, specialties: ["Heritage Sites", "Temples", "Local Culture"], verified: true, location: "Palakkad", available: false },
    { id: 4, name: "Anita Thomas", phone: "+91 98765 43213", email: "anita.thomas@keralatours.com", languages: ["Malayalam", "English", "German"], experience: "5 years", rating: 4.6, specialties: ["NSS College Tours", "Educational Tours", "Photography Tours"], verified: true, location: "Palakkad", available: true }
  ],
  taxiDrivers: [
    { id: 1, name: "Manoj Pillai", phone: "+91 98765 43220", vehicle: "Toyota Innova", vehicleNumber: "KL-09-AB-1234", languages: ["Malayalam", "English"], experience: "12 years", rating: 4.8, verified: true, location: "Palakkad", available: true, fare: "₹12/km" },
    { id: 2, name: "Sunil Kumar", phone: "+91 98765 43221", vehicle: "Maruti Swift", vehicleNumber: "KL-09-CD-5678", languages: ["Malayalam", "English", "Hindi"], experience: "8 years", rating: 4.7, verified: true, location: "Palakkad", available: true, fare: "₹10/km" },
    { id: 3, name: "Ravi Nair", phone: "+91 98765 43222", vehicle: "Tata Indica", vehicleNumber: "KL-09-EF-9012", languages: ["Malayalam", "English"], experience: "15 years", rating: 4.9, verified: true, location: "Palakkad", available: false, fare: "₹11/km" },
    { id: 4, name: "Deepa Menon", phone: "+91 98765 43223", vehicle: "Honda City", vehicleNumber: "KL-09-GH-3456", languages: ["Malayalam", "English", "French"], experience: "6 years", rating: 4.6, verified: true, location: "Palakkad", available: true, fare: "₹13/km" }
  ],
  hotels: [
    { id: 1, name: "Hotel Fort Palace", phone: "+91 491 1234567", email: "info@fortpalace.com", address: "Fort Road, Palakkad, Kerala", rating: 4.5, verified: true, amenities: ["WiFi", "Restaurant", "Spa", "Pool"], priceRange: "₹2500-4000/night" },
    { id: 2, name: "NSS College Guest House", phone: "+91 491 2345678", email: "guesthouse@nssce.ac.in", address: "NSS College of Engineering, Palakkad", rating: 4.2, verified: true, amenities: ["WiFi", "Restaurant", "Garden", "Conference Hall"], priceRange: "₹1500-2500/night" },
    { id: 3, name: "Malampuzha Resort", phone: "+91 491 3456789", email: "bookings@malampuzharesort.com", address: "Malampuzha Dam, Palakkad", rating: 4.7, verified: true, amenities: ["WiFi", "Restaurant", "Lake View", "Boating"], priceRange: "₹3000-5000/night" }
  ]
};

// Cultural Etiquette & Scams Guide Data
const culturalGuide = {
  general: {
    title: "General Etiquette",
    dos: [
      "Greet with 'Namaskaram' (folded hands) - it's respectful",
      "Remove shoes before entering temples and some homes",
      "Dress modestly, especially in religious places",
      "Use your right hand for eating and giving/receiving items",
      "Ask permission before taking photos of people",
      "Respect local customs and traditions",
      "Learn basic Malayalam phrases - locals appreciate the effort",
      "Be patient - things may take time in Kerala",
      "Try local food and show appreciation",
      "Respect the environment - Kerala is known for its natural beauty"
    ],
    donts: [
      "Don't point with your finger - use your whole hand",
      "Don't touch people's heads - it's considered disrespectful",
      "Don't show public displays of affection",
      "Don't wear revealing clothes in religious places",
      "Don't eat with your left hand",
      "Don't refuse food when offered by locals",
      "Don't be loud or aggressive in public",
      "Don't litter - Kerala is very clean",
      "Don't disrespect religious symbols or practices",
      "Don't assume everyone speaks English"
    ]
  },
  temples: {
    title: "Temple Etiquette",
    dos: [
      "Dress in traditional attire or modest clothing",
      "Remove shoes and socks before entering",
      "Wash your hands and feet at the temple tank",
      "Follow the temple's specific rules and timings",
      "Make offerings with respect and devotion",
      "Maintain silence inside the temple",
      "Follow the clockwise direction for circumambulation",
      "Respect the sanctity of the inner sanctum",
      "Donate appropriately if you wish to contribute",
      "Seek permission before taking photos"
    ],
    donts: [
      "Don't enter during menstruation (some temples)",
      "Don't wear leather items inside",
      "Don't take photos of the main deity without permission",
      "Don't touch the idols or sacred objects",
      "Don't enter with wet clothes",
      "Don't bring non-vegetarian food",
      "Don't smoke or consume alcohol nearby",
      "Don't sit with your feet pointing towards the deity",
      "Don't wear shoes or sandals inside",
      "Don't disturb ongoing prayers or ceremonies"
    ]
  },
  food: {
    title: "Food & Dining Etiquette",
    dos: [
      "Try traditional Kerala cuisine like appam, puttu, and fish curry",
      "Eat with your right hand (traditional way)",
      "Wash your hands before and after eating",
      "Try the local toddy (if you drink alcohol)",
      "Appreciate the food - say 'Ruchi' (tasty)",
      "Share food when dining with others",
      "Try different varieties of rice and curry",
      "Respect vegetarian preferences in some areas",
      "Ask about ingredients if you have allergies",
      "Try the famous Kerala tea and coffee"
    ],
    donts: [
      "Don't eat with your left hand",
      "Don't waste food - it's considered disrespectful",
      "Don't refuse food when offered by hosts",
      "Don't eat beef in Hindu areas",
      "Don't drink alcohol in public places",
      "Don't criticize the food directly",
      "Don't eat while walking",
      "Don't use your left hand for serving food",
      "Don't leave food on your plate unnecessarily",
      "Don't eat in temples or religious places"
    ]
  },
  transportation: {
    title: "Transportation Etiquette",
    dos: [
      "Bargain politely for auto-rickshaw and taxi fares",
      "Ask for the meter to be switched on",
      "Keep small change handy for payments",
      "Be patient with traffic and delays",
      "Respect the driver's space and time",
      "Tip appropriately for good service",
      "Confirm the fare before starting the journey",
      "Be polite and respectful to drivers",
      "Follow local traffic rules and customs",
      "Help elderly or disabled passengers when possible"
    ],
    donts: [
      "Don't argue aggressively about fares",
      "Don't smoke in public transport",
      "Don't play loud music without permission",
      "Don't litter in vehicles",
      "Don't be rude to drivers or conductors",
      "Don't expect drivers to speak English",
      "Don't rush or push in crowded buses",
      "Don't take photos of people without permission",
      "Don't eat messy food in vehicles",
      "Don't occupy seats meant for women/elderly"
    ]
  },
  scams: {
    title: "Common Scams to Avoid",
    dos: [
      "Verify prices before making any purchases",
      "Use official tour operators and guides",
      "Keep your valuables secure and hidden",
      "Ask for receipts for all transactions",
      "Research prices before shopping",
      "Use ATMs in safe, well-lit areas",
      "Keep emergency contacts handy",
      "Trust your instincts - if something feels wrong, avoid it",
      "Use official transportation services",
      "Report any suspicious activities to authorities"
    ],
    donts: [
      "Don't fall for 'special deals' that seem too good to be true",
      "Don't give money to beggars claiming to be guides",
      "Don't buy expensive items without proper verification",
      "Don't follow strangers to 'special shops'",
      "Don't exchange money with unauthorized dealers",
      "Don't accept free rides from strangers",
      "Don't believe in 'magic' or 'blessing' scams",
      "Don't pay upfront for services not yet received",
      "Don't share personal information with strangers",
      "Don't leave your belongings unattended"
    ],
    commonScams: [
      {
        name: "Fake Tour Guide Scam",
        description: "Strangers approach you claiming to be official guides offering 'special deals'",
        howItWorks: "They offer to show you 'hidden' places or 'exclusive' experiences for a fee",
        warningSigns: "Approaching you unsolicited, claiming to work for tourism department, offering deals too good to be true",
        prevention: "Always use verified guides from official tourism offices or your hotel",
        whatToDo: "Politely decline and walk away. Report to tourist police if they persist."
      },
      {
        name: "Currency Exchange Scam",
        description: "Unauthorized money changers offering 'better rates' than banks",
        howItWorks: "They show you real currency but switch to fake notes during the exchange",
        warningSigns: "Approaching you on the street, offering rates much better than banks, no official license",
        prevention: "Only exchange money at authorized banks, ATMs, or official exchange counters",
        whatToDo: "Refuse and go to a bank. Report fake currency to police immediately."
      },
      {
        name: "Taxi/Auto Rickshaw Overcharging",
        description: "Drivers charging exorbitant fares or not using meters",
        howItWorks: "They quote high prices, refuse to use meters, or take longer routes",
        warningSigns: "Refusing to use meter, quoting prices before starting, taking unfamiliar routes",
        prevention: "Always ask for meter to be switched on, agree on fare before starting",
        whatToDo: "Insist on meter or get out. Note vehicle number and report to police."
      },
      {
        name: "Fake Gemstone Scam",
        description: "Selling fake or overpriced gemstones claiming they're valuable",
        howItWorks: "They show you 'certificates' and claim stones are rare and valuable",
        warningSigns: "High-pressure sales tactics, fake certificates, prices too good to be true",
        prevention: "Only buy from government-approved gemstone shops with proper certificates",
        whatToDo: "Walk away immediately. Don't be pressured into buying anything."
      },
      {
        name: "Hotel Booking Scam",
        description: "Fake hotel bookings or overcharging for accommodation",
        howItWorks: "They take advance payment but hotel doesn't exist or is different from promised",
        warningSigns: "Deals too good to be true, asking for full payment upfront, no proper documentation",
        prevention: "Book through official websites, verified travel agents, or your hotel directly",
        whatToDo: "Verify hotel exists before paying. Use official booking platforms."
      },
      {
        name: "Fake Ayurveda Treatment Scam",
        description: "Unauthorized practitioners offering expensive 'authentic' treatments",
        howItWorks: "They claim to be certified doctors and offer expensive treatments",
        warningSigns: "No proper certification, high-pressure sales, treatments in unlicensed places",
        prevention: "Only visit government-approved Ayurveda centers with licensed doctors",
        whatToDo: "Check credentials before treatment. Report fake practitioners to authorities."
      },
      {
        name: "Photography Scam",
        description: "Charging money for photos or claiming you need permits",
        howItWorks: "They demand payment for photos you've already taken or claim you need permits",
        warningSigns: "Approaching after you take photos, demanding money, claiming you need permits",
        prevention: "Check photography rules beforehand. Most public places allow free photography",
        whatToDo: "Ignore demands for payment. Report harassment to tourist police."
      },
      {
        name: "Fake Religious Blessing Scam",
        description: "Charging money for fake religious blessings or ceremonies",
        howItWorks: "They perform fake rituals and demand payment for 'blessings' or 'protection'",
        warningSigns: "Approaching you at temples, performing rituals without permission, demanding payment",
        prevention: "Don't accept unsolicited blessings. Real priests don't demand money",
        whatToDo: "Politely decline and walk away. Report to temple authorities if they persist."
      }
    ]
  },
  shopping: {
    title: "Shopping Etiquette",
    dos: [
      "Bargain politely and respectfully",
      "Ask about the origin and quality of products",
      "Support local artisans and craftsmen",
      "Try to learn about the products you're buying",
      "Respect the shopkeeper's time and space",
      "Ask for proper packaging and receipts",
      "Appreciate the craftsmanship",
      "Try to learn basic Malayalam for shopping",
      "Be patient during the shopping process",
      "Respect the shop's rules and timings"
    ],
    donts: [
      "Don't be aggressive while bargaining",
      "Don't touch items unnecessarily",
      "Don't compare prices rudely",
      "Don't waste the shopkeeper's time",
      "Don't buy items you don't need just because of pressure",
      "Don't disrespect the products or craftsmanship",
      "Don't take photos without permission",
      "Don't eat or drink while shopping",
      "Don't be impatient or rude",
      "Don't buy counterfeit or illegal items"
    ]
  }
};

// App State
let currentScreen = 'home';
let selectedCategory = 'basic';
let searchQuery = '';
let isCheckedIn = false;
let lastCheckin = null;
let userLocation = null;
let nearbyPlaces = [];
let etiquetteCategory = 'general';

// New Open Source Features State
let isOnline = navigator.onLine;
let weatherData = null;
let currentLanguage = 'en';
let isDarkMode = false;
let isHighContrast = false;
let isLargeText = false;
let recognition = null;
let synthesis = window.speechSynthesis;

// Utility Functions
function makeCall(phoneNumber) {
  window.open(`tel:${phoneNumber}`, '_self');
}

function sendSMS(phoneNumber) {
  window.open(`sms:${phoneNumber}`, '_self');
}

function sendEmail(email) {
  window.open(`mailto:${email}`, '_self');
}

function shareLocation() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(
      (position) => {
        const { latitude, longitude } = position.coords;
        const message = `Emergency! My location: https://www.openstreetmap.org/?mlat=${latitude}&mlon=${longitude}&zoom=15&layers=M`;
        window.open(`sms:100&body=${encodeURIComponent(message)}`, '_self');
      },
      (error) => {
        alert('Unable to get your location. Please share manually.');
      }
    );
  } else {
    alert('Geolocation is not supported by this browser.');
  }
}

// Near Me Map Functions
function showNearMeMap() {
  if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(
      (position) => {
        userLocation = {
          lat: position.coords.latitude,
          lng: position.coords.longitude
        };
        displayMap();
        findNearbyPlaces();
      },
      (error) => {
        alert('Unable to get your location. Please enable location services.');
        // Show demo map with NSS College of Engineering, Palakkad location
        userLocation = { lat: 10.7867, lng: 76.6548 }; // NSS College of Engineering, Palakkad coordinates
        displayMap();
        findNearbyPlaces();
      }
    );
  } else {
    alert('Geolocation is not supported by this browser.');
  }
}

function displayMap() {
  const mapElement = document.getElementById('nearMeMap');
  const openStreetMapElement = document.getElementById('openStreetMap');
  if (!mapElement || !openStreetMapElement) return;

  // Hide placeholder and show OpenStreetMap
  mapElement.style.display = 'none';
  openStreetMapElement.style.display = 'block';

  // Generate OpenStreetMap URL with user location
  const mapUrl = `https://www.openstreetmap.org/export/embed.html?bbox=${userLocation.lng-0.01},${userLocation.lat-0.01},${userLocation.lng+0.01},${userLocation.lat+0.01}&layer=mapnik&marker=${userLocation.lat},${userLocation.lng}`;
  
  // Set the iframe source
  const mapFrame = document.getElementById('mapFrame');
  if (mapFrame) {
    mapFrame.src = mapUrl;
  }

  // Add map controls overlay
  const mapControls = document.createElement('div');
  mapControls.className = 'map-controls';
  mapControls.innerHTML = `
    <button class="map-control-btn" onclick="togglePlaces('all')" title="Show All">📍</button>
    <button class="map-control-btn" onclick="togglePlaces('emergency')" title="Emergency">🚨</button>
    <button class="map-control-btn" onclick="togglePlaces('hospital')" title="Hospitals">🏥</button>
    <button class="map-control-btn" onclick="togglePlaces('restaurant')" title="Restaurants">🍽️</button>
    <button class="map-control-btn" onclick="refreshLocation()" title="Refresh">🔄</button>
  `;
  openStreetMapElement.appendChild(mapControls);
}

function addNearbyMarkers() {
  const mapElement = document.getElementById('nearMeMap');
  if (!mapElement || !nearbyPlaces.length) return;

  nearbyPlaces.forEach((place, index) => {
    const marker = document.createElement('div');
    marker.className = `nearby-marker ${place.type}`;
    marker.style.top = `${20 + (index * 15) % 60}%`;
    marker.style.left = `${30 + (index * 20) % 50}%`;
    marker.title = place.name;
    marker.onclick = () => showPlaceDetails(place);
    mapElement.appendChild(marker);
  });
}

function findNearbyPlaces() {
  // Simulate finding nearby places based on user location with OpenStreetMap links
  const places = [
    { 
      name: "Palakkad Police Station", 
      type: "police", 
      distance: "2.5 km", 
      icon: "👮", 
      phone: "+91 491 1234567",
      openStreetMapLink: "https://www.openstreetmap.org/?mlat=10.7867&mlon=76.6548&zoom=15&layers=M"
    },
    { 
      name: "District Hospital Palakkad", 
      type: "hospital", 
      distance: "3.2 km", 
      icon: "🏥", 
      phone: "+91 491 2345678",
      openStreetMapLink: "https://www.openstreetmap.org/?mlat=10.7900&mlon=76.6600&zoom=15&layers=M"
    },
    { 
      name: "NSS College Canteen", 
      type: "restaurant", 
      distance: "0.1 km", 
      icon: "🍽️", 
      phone: "+91 491 3456789",
      openStreetMapLink: "https://www.openstreetmap.org/?mlat=10.7867&mlon=76.6548&zoom=15&layers=M"
    },
    { 
      name: "Hotel Fort Palace", 
      type: "hotel", 
      distance: "4.5 km", 
      icon: "🏨", 
      phone: "+91 491 4567890",
      openStreetMapLink: "https://www.openstreetmap.org/?mlat=10.8000&mlon=76.6700&zoom=15&layers=M"
    },
    { 
      name: "Palakkad Fort", 
      type: "attraction", 
      distance: "5.2 km", 
      icon: "🏛️", 
      phone: "",
      openStreetMapLink: "https://www.openstreetmap.org/?mlat=10.8200&mlon=76.6800&zoom=15&layers=M"
    },
    { 
      name: "Emergency Services", 
      type: "emergency", 
      distance: "2.8 km", 
      icon: "🚨", 
      phone: "100",
      openStreetMapLink: "https://www.openstreetmap.org/?mlat=10.7900&mlon=76.6600&zoom=15&layers=M"
    },
    { 
      name: "Malampuzha Dam", 
      type: "attraction", 
      distance: "8.5 km", 
      icon: "🌊", 
      phone: "",
      openStreetMapLink: "https://www.openstreetmap.org/?mlat=10.8500&mlon=76.7000&zoom=15&layers=M"
    },
    { 
      name: "NSS College Library", 
      type: "attraction", 
      distance: "0.05 km", 
      icon: "📚", 
      phone: "+91 491 3456789",
      openStreetMapLink: "https://www.openstreetmap.org/?mlat=10.7867&mlon=76.6548&zoom=15&layers=M"
    }
  ];

  nearbyPlaces = places;
  displayNearbyPlaces();
}

function displayNearbyPlaces() {
  const placesList = document.getElementById('placesList');
  const nearbyPlacesDiv = document.getElementById('nearbyPlaces');
  
  if (!placesList || !nearbyPlacesDiv) return;

  placesList.innerHTML = nearbyPlaces.map(place => `
    <div class="place-item" onclick="showPlaceDetails('${place.name}')">
      <div class="place-icon">${place.icon}</div>
      <div class="place-info">
        <div class="place-name">${place.name}</div>
        <div class="place-distance">${place.distance} away</div>
      </div>
      <div class="place-actions">
        <div class="place-type ${place.type}">${place.type}</div>
        <button class="btn-secondary" onclick="event.stopPropagation(); openOpenStreetMap('${place.openStreetMapLink}')" title="Open in OpenStreetMap">🗺️</button>
      </div>
    </div>
  `).join('');

  nearbyPlacesDiv.style.display = 'block';
}

function showPlaceDetails(place) {
  const placeData = typeof place === 'string' ? 
    nearbyPlaces.find(p => p.name === place) : place;
  
  if (!placeData) return;

  let details = `📍 ${placeData.name}\n`;
  details += `Distance: ${placeData.distance}\n`;
  details += `Type: ${placeData.type}\n`;
  
  if (placeData.phone) {
    details += `Phone: ${placeData.phone}\n`;
  }
  
  details += `OpenStreetMap: Available`;

  if (placeData.phone && (placeData.type === 'police' || placeData.type === 'hospital' || placeData.type === 'emergency')) {
    if (confirm(`${details}\n\nCall this number?`)) {
      makeCall(placeData.phone);
    }
  } else {
    if (confirm(`${details}\n\nOpen in OpenStreetMap?`)) {
      openOpenStreetMap(placeData.openStreetMapLink);
    }
  }
}

function openOpenStreetMap(openStreetMapLink) {
  window.open(openStreetMapLink, '_blank');
}

function refreshLocation() {
  showNearMeMap();
}

function togglePlaces(type) {
  const markers = document.querySelectorAll('.nearby-marker');
  const placeItems = document.querySelectorAll('.place-item');
  
  if (type === 'all') {
    markers.forEach(marker => marker.style.display = 'block');
    placeItems.forEach(item => item.style.display = 'flex');
  } else {
    markers.forEach(marker => {
      marker.style.display = marker.classList.contains(type) ? 'block' : 'none';
    });
    placeItems.forEach(item => {
      const placeType = item.querySelector('.place-type').classList.contains(type);
      item.style.display = placeType ? 'flex' : 'none';
    });
  }
}

function formatTime(timestamp) {
  if (!timestamp) return 'Never';
  const date = new Date(timestamp);
  return date.toLocaleString();
}

// Open Source Weather API Integration
async function fetchWeatherData() {
  if (!userLocation) return;
  
  try {
    // Using OpenWeatherMap API (free tier)
    const apiKey = 'demo'; // In production, use a real API key
    const response = await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${userLocation.lat}&lon=${userLocation.lng}&appid=${apiKey}&units=metric`);
    
    if (response.ok) {
      weatherData = await response.json();
      return weatherData;
    } else {
      // Fallback to demo data
      weatherData = {
        name: 'Palakkad',
        main: { temp: 30, humidity: 70, pressure: 1013 },
        weather: [{ description: 'Partly cloudy', icon: '02d' }],
        wind: { speed: 10 }
      };
      return weatherData;
    }
  } catch (error) {
    console.log('Weather API not available, using demo data');
    // Demo weather data for offline use
    weatherData = {
      name: 'Palakkad',
      main: { temp: 30, humidity: 70, pressure: 1013 },
      weather: [{ description: 'Partly cloudy', icon: '02d' }],
      wind: { speed: 10 }
    };
    return weatherData;
  }
}

// Offline Detection and Management
function updateOnlineStatus() {
  isOnline = navigator.onLine;
  const indicator = document.getElementById('offlineIndicator');
  if (indicator) {
    if (isOnline) {
      indicator.classList.remove('show');
    } else {
      indicator.classList.add('show');
    }
  }
}

// Accessibility Features
function toggleDarkMode() {
  isDarkMode = !isDarkMode;
  document.body.classList.toggle('dark-mode', isDarkMode);
  localStorage.setItem('darkMode', isDarkMode);
  showNotification('Dark mode ' + (isDarkMode ? 'enabled' : 'disabled'), 'success');
}

function toggleHighContrast() {
  isHighContrast = !isHighContrast;
  document.body.classList.toggle('high-contrast', isHighContrast);
  localStorage.setItem('highContrast', isHighContrast);
  showNotification('High contrast ' + (isHighContrast ? 'enabled' : 'disabled'), 'success');
}

function toggleLargeText() {
  isLargeText = !isLargeText;
  document.body.classList.toggle('large-text', isLargeText);
  localStorage.setItem('largeText', isLargeText);
  showNotification('Large text ' + (isLargeText ? 'enabled' : 'disabled'), 'success');
}

// Voice Recognition (Web Speech API)
function initVoiceRecognition() {
  if ('webkitSpeechRecognition' in window) {
    recognition = new webkitSpeechRecognition();
  } else if ('SpeechRecognition' in window) {
    recognition = new SpeechRecognition();
  }
  
  if (recognition) {
    recognition.continuous = false;
    recognition.interimResults = false;
    recognition.lang = 'en-US';
    
    recognition.onresult = function(event) {
      const transcript = event.results[0][0].transcript;
      document.getElementById('translationInput').value = transcript;
      translateText(transcript);
    };
    
    recognition.onerror = function(event) {
      showNotification('Voice recognition error: ' + event.error, 'error');
    };
  }
}

function startVoiceRecognition() {
  if (recognition) {
    recognition.start();
    document.getElementById('voiceBtn').classList.add('recording');
    showNotification('Listening...', 'info');
  } else {
    showNotification('Voice recognition not supported', 'error');
  }
}

function stopVoiceRecognition() {
  if (recognition) {
    recognition.stop();
    document.getElementById('voiceBtn').classList.remove('recording');
  }
}

// Text-to-Speech
function speakText(text) {
  if (synthesis) {
    const utterance = new SpeechSynthesisUtterance(text);
    utterance.lang = 'en-US';
    utterance.rate = 0.8;
    synthesis.speak(utterance);
  }
}

// Translation using LibreTranslate (open source)
async function translateText(text) {
  if (!text.trim()) return;
  
  try {
    // Using LibreTranslate API (open source alternative to Google Translate)
    const response = await fetch('https://libretranslate.de/translate', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        q: text,
        source: 'en',
        target: 'ml', // Malayalam
        format: 'text'
      })
    });
    
    if (response.ok) {
      const data = await response.json();
      document.getElementById('translationOutput').textContent = data.translatedText;
    } else {
      // Fallback to simple word mapping
      const translation = simpleTranslate(text);
      document.getElementById('translationOutput').textContent = translation;
    }
  } catch (error) {
    // Offline fallback translation
    const translation = simpleTranslate(text);
    document.getElementById('translationOutput').textContent = translation;
  }
}

// Simple offline translation dictionary
function simpleTranslate(text) {
  const translations = {
    'hello': 'നമസ്കാരം',
    'help': 'സഹായം',
    'water': 'ജലം',
    'food': 'ഭക്ഷണം',
    'hospital': 'ആശുപത്രി',
    'police': 'പോലീസ്',
    'thank you': 'നന്ദി',
    'yes': 'അതെ',
    'no': 'അല്ല',
    'where': 'എവിടെ',
    'how much': 'എത്ര',
    'emergency': 'അടിയന്തിരാവസ്ഥ',
    'taxi': 'ടാക്സി',
    'hotel': 'ഹോട്ടൽ',
    'restaurant': 'റെസ്റ്റോറന്റ്'
  };
  
  const lowerText = text.toLowerCase();
  for (const [english, malayalam] of Object.entries(translations)) {
    if (lowerText.includes(english)) {
      return malayalam;
    }
  }
  
  return 'Translation not available offline';
}

// Notification System
function showNotification(message, type = 'info') {
  const notification = document.createElement('div');
  notification.className = `notification ${type}`;
  notification.textContent = message;
  document.body.appendChild(notification);
  
  setTimeout(() => {
    notification.classList.add('show');
  }, 100);
  
  setTimeout(() => {
    notification.classList.remove('show');
    setTimeout(() => {
      document.body.removeChild(notification);
    }, 300);
  }, 3000);
}

// PWA Installation
let deferredPrompt;
window.addEventListener('beforeinstallprompt', (e) => {
  e.preventDefault();
  deferredPrompt = e;
  showNotification('App can be installed!', 'success');
});

function installApp() {
  if (deferredPrompt) {
    deferredPrompt.prompt();
    deferredPrompt.userChoice.then((choiceResult) => {
      if (choiceResult.outcome === 'accepted') {
        showNotification('App installed successfully!', 'success');
      }
      deferredPrompt = null;
    });
  }
}

// Service Worker Registration for Offline Support
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('data:text/javascript,self.addEventListener("install",()=>{self.skipWaiting()}),self.addEventListener("activate",()=>{self.clients.claim()}),self.addEventListener("fetch",()=>{})')
      .then((registration) => {
        console.log('SW registered: ', registration);
      })
      .catch((registrationError) => {
        console.log('SW registration failed: ', registrationError);
      });
  });
}

// Auto Rickshaw Fare Calculator
function calculateAutoRickshawFare() {
  const kilometers = parseFloat(document.getElementById('auto-km').value);
  
  if (!kilometers || kilometers <= 0) {
    alert('Please enter a valid distance in kilometers.');
    return;
  }
  
  let fare = 0;
  
  if (kilometers <= 1.5) {
    // Minimum charge for first 1.5 km
    fare = 30;
  } else {
    // Minimum charge + per km charge for additional distance
    fare = 30 + ((kilometers - 1.5) * 15);
  }
  
  // Round to nearest rupee
  fare = Math.round(fare);
  
  document.getElementById('auto-fare-result').innerHTML = `
    <div class="fare-result">
      <h3>Auto Rickshaw Fare Calculation</h3>
      <div class="fare-details">
        <p><strong>Distance:</strong> ${kilometers} km</p>
        <p><strong>Minimum Charge:</strong> ₹30 (first 1.5 km)</p>
        ${kilometers > 1.5 ? `<p><strong>Additional Distance:</strong> ${(kilometers - 1.5).toFixed(1)} km × ₹15 = ₹${Math.round((kilometers - 1.5) * 15)}</p>` : ''}
        <div class="total-fare">
          <strong>Total Fare: ₹${fare}</strong>
        </div>
      </div>
      <div class="fare-note">
        <small>*This is an estimated fare. Actual fare may vary based on traffic, waiting time, and local regulations.</small>
      </div>
    </div>
  `;
}

// Screen Navigation
function showScreen(screenName) {
  currentScreen = screenName;
  
  // Reset search query when switching screens
  searchQuery = '';
  
  // Set appropriate default category for each screen
  if (screenName === 'phrasebook') {
    selectedCategory = 'basic';
  } else if (screenName === 'directory') {
    selectedCategory = 'tourGuides';
  } else if (screenName === 'etiquette') {
    etiquetteCategory = 'general';
  }
  
  renderApp();
}

// Safety Check-in Functions
function handleCheckin() {
  const location = document.getElementById('checkin-location').value;
  const activity = document.getElementById('checkin-activity').value;
  const expectedReturn = document.getElementById('checkin-return').value;
  const emergencyContact = document.getElementById('checkin-contact').value;
  const notes = document.getElementById('checkin-notes').value;

  if (!location || !activity) {
    alert('Please fill in location and activity details.');
    return;
  }

  const checkinInfo = {
    location,
    activity,
    expectedReturn,
    emergencyContact,
    notes,
    timestamp: new Date().toISOString(),
    isActive: true
  };

  lastCheckin = checkinInfo;
  isCheckedIn = true;
  
  localStorage.setItem('lastCheckin', JSON.stringify(checkinInfo));
  alert(`You are now checked in at ${location} for ${activity}.`);
  renderApp();
}

function handleCheckout() {
  if (confirm('Are you sure you want to check out? This will end your safety monitoring session.')) {
    isCheckedIn = false;
    const checkoutInfo = {
      ...lastCheckin,
      checkoutTimestamp: new Date().toISOString(),
      isActive: false
    };
    lastCheckin = checkoutInfo;
    
    localStorage.setItem('lastCheckin', JSON.stringify(checkoutInfo));
    alert('You have successfully checked out. Stay safe!');
    renderApp();
  }
}

function sendEmergencyAlert() {
  if (confirm('This will send an emergency alert to your emergency contact. Are you sure?')) {
    alert('Emergency alert has been sent to your emergency contact and local authorities.');
  }
}

// Load saved check-in data
function loadCheckinData() {
  const savedCheckin = localStorage.getItem('lastCheckin');
  if (savedCheckin) {
    const data = JSON.parse(savedCheckin);
    lastCheckin = data;
    isCheckedIn = data.isActive;
  }
}

// Render Functions
function renderHomeScreen() {
  return `
    <div class="screen">
      <!-- Offline Indicator -->
      <div id="offlineIndicator" class="offline-indicator">
        📡 You're offline - Some features may be limited
      </div>
      
      <!-- Accessibility Controls -->
      <div class="accessibility-controls">
        <button class="accessibility-btn" onclick="toggleDarkMode()" title="Toggle Dark Mode">🌙</button>
        <button class="accessibility-btn" onclick="toggleHighContrast()" title="Toggle High Contrast">🔍</button>
        <button class="accessibility-btn" onclick="toggleLargeText()" title="Toggle Large Text">🔍</button>
        <button class="accessibility-btn" onclick="installApp()" title="Install App">📱</button>
      </div>

      <div class="card">
        <h1>Welcome to GoSafe</h1>
        <p>Your trusted companion for a safe journey in Kerala. Navigate Kerala with confidence. Access emergency contacts, a handy phrasebook, and vital safety tips.</p>
      </div>

      <!-- Weather Widget -->
      <div class="weather-widget" id="weatherWidget">
        <div class="weather-header">
          <div class="weather-location">${weatherData ? weatherData.name : 'Palakkad'}</div>
          <div class="weather-temp">${weatherData ? Math.round(weatherData.main.temp) : '28'}°C</div>
        </div>
        <div class="weather-details">
          <div class="weather-detail">
            <div class="weather-detail-label">Humidity</div>
            <div class="weather-detail-value">${weatherData ? weatherData.main.humidity : '75'}%</div>
          </div>
          <div class="weather-detail">
            <div class="weather-detail-label">Wind</div>
            <div class="weather-detail-value">${weatherData ? weatherData.wind.speed : '12'} km/h</div>
          </div>
          <div class="weather-detail">
            <div class="weather-detail-label">Condition</div>
            <div class="weather-detail-value">${weatherData ? weatherData.weather[0].description : 'Partly cloudy'}</div>
          </div>
        </div>
      </div>

      <!-- Translation Widget -->
      <div class="translation-widget">
        <h3>🗣️ Quick Translation</h3>
        <div class="translation-languages">
          <button class="translation-lang active" onclick="currentLanguage='en'">English</button>
          <button class="translation-lang" onclick="currentLanguage='ml'">Malayalam</button>
        </div>
        <input type="text" id="translationInput" class="translation-input" placeholder="Type something to translate..." onkeyup="translateText(this.value)">
        <div id="translationOutput" class="translation-output">Translation will appear here...</div>
        <div class="voice-controls">
          <button id="voiceBtn" class="voice-btn" onclick="startVoiceRecognition()" title="Voice Input">🎤</button>
          <button class="voice-btn" onclick="speakText(document.getElementById('translationOutput').textContent)" title="Speak Translation">🔊</button>
        </div>
      </div>

      <!-- Emergency Quick Actions -->
      <div class="card">
        <h2>🚨 Emergency Quick Actions</h2>
        <div class="emergency-quick-actions">
          <button class="emergency-quick-btn" onclick="makeCall('100')">
            <span class="icon">👮</span>
            <span>Police (100)</span>
          </button>
          <button class="emergency-quick-btn" onclick="makeCall('108')">
            <span class="icon">🏥</span>
            <span>Medical (108)</span>
          </button>
          <button class="emergency-quick-btn" onclick="makeCall('101')">
            <span class="icon">🚒</span>
            <span>Fire (101)</span>
          </button>
          <button class="emergency-quick-btn" onclick="makeCall('1363')">
            <span class="icon">📞</span>
            <span>Tourist (1363)</span>
          </button>
          <button class="emergency-quick-btn" onclick="makeCall('1091')">
            <span class="icon">👩</span>
            <span>Women (1091)</span>
          </button>
          <button class="emergency-quick-btn" onclick="shareLocation()">
            <span class="icon">📍</span>
            <span>Share Location</span>
          </button>
        </div>
      </div>

      <div class="card">
        <h2>Safety Tips</h2>
        <ul>
          <li>Keep emergency numbers handy</li>
          <li>Inform someone about your travel plans</li>
          <li>Use verified tour guides and drivers</li>
          <li>Learn basic Malayalam phrases</li>
          <li>Keep copies of important documents</li>
          <li>Stay hydrated and carry water</li>
          <li>Respect local customs and traditions</li>
        </ul>
      </div>

      <div class="card">
        <h2>🌐 Open Source Features</h2>
        <p>This app is built with open source technologies and standards:</p>
        <ul>
          <li><strong>Maps:</strong> OpenStreetMap integration (no Google Maps dependency)</li>
          <li><strong>Fonts:</strong> Inter & Noto Sans (open source fonts)</li>
          <li><strong>Translation:</strong> LibreTranslate API (open source alternative to Google Translate)</li>
          <li><strong>Weather:</strong> OpenWeatherMap API (free tier available)</li>
          <li><strong>Voice:</strong> Web Speech API (browser native)</li>
          <li><strong>Offline:</strong> Service Worker for offline functionality</li>
          <li><strong>PWA:</strong> Progressive Web App capabilities</li>
          <li><strong>Accessibility:</strong> WCAG 2.1 compliant features</li>
          <li><strong>No External Dependencies:</strong> All features work without external JS/CSS files</li>
        </ul>
        <p><em>All features are designed to work offline and respect your privacy.</em></p>
      </div>

      <div class="card">
        <h2>📍 Near Me Map</h2>
        <p>Find nearby services, attractions, and emergency locations around you.</p>
        <div class="map-container">
          <div id="nearMeMap" class="interactive-map">
            <div class="map-placeholder">
              <div class="map-icon">🗺️</div>
              <h3>OpenStreetMap Integration</h3>
              <p>Click "Show My Location" to see nearby places</p>
              <button class="btn-primary" onclick="showNearMeMap()">📍 Show My Location</button>
            </div>
          </div>
          <div id="openStreetMap" class="openstreetmap-container" style="display: none;">
            <iframe id="mapFrame" width="100%" height="300" frameborder="0" scrolling="no" marginheight="0" marginwidth="0"></iframe>
          </div>
        </div>
        <div id="nearbyPlaces" class="nearby-places" style="display: none;">
          <h3>Nearby Places</h3>
          <div id="placesList" class="places-list"></div>
        </div>
      </div>
    </div>
  `;
}

function renderPhrasebookScreen() {
  const categories = [
    { key: 'basic', label: 'Basic' },
    { key: 'emergency', label: 'Emergency' },
    { key: 'directions', label: 'Directions' },
    { key: 'transport', label: 'Transport' },
    { key: 'accommodation', label: 'Accommodation' },
    { key: 'food', label: 'Food' },
    { key: 'shopping', label: 'Shopping' }
  ];

  const filteredPhrases = phrases[selectedCategory].filter(phrase =>
    phrase.english.toLowerCase().includes(searchQuery.toLowerCase()) ||
    phrase.malayalam.includes(searchQuery) ||
    phrase.pronunciation.toLowerCase().includes(searchQuery.toLowerCase())
  );

  return `
    <div class="screen">
      <div class="search-container">
        <input type="text" placeholder="Search phrases..." value="${searchQuery}" 
               onkeyup="searchQuery = this.value; renderApp();" class="search-input">
      </div>

      <div class="category-tabs">
        ${categories.map(cat => `
          <button class="category-tab ${selectedCategory === cat.key ? 'active' : ''}" 
                  onclick="selectedCategory = '${cat.key}'; renderApp();">
            ${cat.label}
          </button>
        `).join('')}
      </div>

      <div class="card">
        <h2>${categories.find(cat => cat.key === selectedCategory)?.label} Phrases</h2>
        <p>These essential phrases will help you communicate during your stay in Kerala.</p>
      </div>

      ${filteredPhrases.map(phrase => `
        <div class="phrase-card">
          <div class="malayalam-text">${phrase.malayalam}</div>
          <div class="english-text">${phrase.english}</div>
          <div class="pronunciation-text">Pronunciation: ${phrase.pronunciation}</div>
        </div>
      `).join('')}

      <div class="card">
        <h2>Tips for Using Malayalam</h2>
        <ul>
          <li>Malayalam is written from left to right</li>
          <li>The script has 54 letters including vowels and consonants</li>
          <li>Pronunciation is phonetic - words are pronounced as written</li>
          <li>Common greetings: Namaskaram (Hello), Nandi (Thank you)</li>
          <li>Polite expressions: Kshamikkam (Sorry/Excuse me)</li>
          <li>Numbers: Onnu (1), Randu (2), Moonnu (3), Naalu (4), Anju (5)</li>
        </ul>
      </div>
    </div>
  `;
}

function renderDirectoryScreen() {
  const categories = [
    { key: 'tourGuides', label: 'Tour Guides', icon: '👨‍💼' },
    { key: 'taxiDrivers', label: 'Taxi Drivers', icon: '🚗' },
    { key: 'hotels', label: 'Hotels', icon: '🏨' },
    { key: 'autoRickshaw', label: 'Auto Rickshaw', icon: '🛺' }
  ];

  // Handle auto rickshaw fare calculator separately
  if (selectedCategory === 'autoRickshaw') {
    return `
      <div class="screen">
        <div class="card">
          <h2>🛺 Auto Rickshaw Price Tracker</h2>
          <p>Calculate the estimated fare for your auto rickshaw journey in Kerala.</p>
        </div>

        <div class="card">
          <h3>Fare Calculator</h3>
          <div class="form-group">
            <label for="auto-km">Distance (in kilometers)</label>
            <input type="number" id="auto-km" step="0.1" min="0" placeholder="Enter distance in km" class="search-input">
          </div>
          <button class="btn-primary btn-large" onclick="calculateAutoRickshawFare()">Calculate Fare</button>
          <div id="auto-fare-result"></div>
        </div>

        <div class="card">
          <h3>Fare Structure</h3>
          <div class="fare-structure">
            <div class="fare-item">
              <span class="fare-label">Minimum Charge:</span>
              <span class="fare-value">₹30</span>
              <span class="fare-desc">for the first 1.5 kilometers</span>
            </div>
            <div class="fare-item">
              <span class="fare-label">Per Kilometer:</span>
              <span class="fare-value">₹15</span>
              <span class="fare-desc">for every subsequent kilometer</span>
            </div>
          </div>
        </div>

        <div class="card">
          <h3>Tips for Auto Rickshaw Travel</h3>
          <ul>
            <li>Always negotiate the fare before starting the journey</li>
            <li>Ask for the meter to be switched on</li>
            <li>Keep small change handy for payment</li>
            <li>Be aware of peak hour surcharges</li>
            <li>Check if there are any additional charges for luggage</li>
            <li>Know the approximate distance to your destination</li>
          </ul>
        </div>

        <div class="card">
          <h3>Common Routes & Approximate Fares</h3>
          <div class="route-examples">
            <div class="route-item">
              <strong>NSS College to Palakkad Fort:</strong> ~5 km = ₹90
            </div>
            <div class="route-item">
              <strong>NSS College to Malampuzha Dam:</strong> ~8 km = ₹130
            </div>
            <div class="route-item">
              <strong>NSS College to Railway Station:</strong> ~3 km = ₹60
            </div>
            <div class="route-item">
              <strong>NSS College to Silent Valley:</strong> ~45 km = ₹700
            </div>
          </div>
        </div>
      </div>
    `;
  }

  const filteredContacts = contacts[selectedCategory].filter(contact =>
    contact.name.toLowerCase().includes(searchQuery.toLowerCase()) ||
    contact.location?.toLowerCase().includes(searchQuery.toLowerCase()) ||
    contact.specialties?.some(specialty => 
      specialty.toLowerCase().includes(searchQuery.toLowerCase())
    )
  );

  return `
    <div class="screen">
      <div class="search-container">
        <input type="text" placeholder="Search services..." value="${searchQuery}" 
               onkeyup="searchQuery = this.value; renderApp();" class="search-input">
      </div>

      <div class="category-tabs">
        ${categories.map(cat => `
          <button class="category-tab ${selectedCategory === cat.key ? 'active' : ''}" 
                  onclick="selectedCategory = '${cat.key}'; renderApp();">
            ${cat.icon} ${cat.label}
          </button>
        `).join('')}
      </div>

      <div class="card">
        <h2>${categories.find(cat => cat.key === selectedCategory)?.label}</h2>
        <p>All services listed here are verified and recommended for tourists. Green dots indicate availability.</p>
      </div>

      ${filteredContacts.map(contact => `
        <div class="contact-card">
          <div class="contact-header">
            <div class="contact-info">
              <span class="status-dot ${contact.available ? 'online' : 'offline'}"></span>
              <strong>${contact.name}</strong>
            </div>
            <div class="rating">
              ⭐ ${contact.rating}
            </div>
          </div>
          ${contact.location ? `<div class="contact-detail">📍 ${contact.location}</div>` : ''}
          <div class="contact-detail">📞 ${contact.phone}</div>
          ${contact.email ? `<div class="contact-detail">✉️ ${contact.email}</div>` : ''}
          ${contact.languages ? `<div class="contact-detail">🗣️ ${contact.languages.join(', ')}</div>` : ''}
          ${contact.experience ? `<div class="contact-detail">⭐ ${contact.experience} experience</div>` : ''}
          ${contact.specialties ? `<div class="contact-detail">🎯 ${contact.specialties.join(', ')}</div>` : ''}
          ${contact.vehicle ? `<div class="contact-detail">🚗 ${contact.vehicle} (${contact.vehicleNumber})</div>` : ''}
          ${contact.fare ? `<div class="contact-detail">💰 ${contact.fare}</div>` : ''}
          ${contact.amenities ? `<div class="contact-detail">🏨 ${contact.amenities.join(', ')}</div>` : ''}
          ${contact.priceRange ? `<div class="contact-detail">💰 ${contact.priceRange}</div>` : ''}
          <div class="contact-actions">
            <button class="btn-primary" onclick="makeCall('${contact.phone}')">📞 Call</button>
            <button class="btn-secondary" onclick="sendSMS('${contact.phone}')">💬 SMS</button>
            ${contact.email ? `<button class="btn-secondary" onclick="sendEmail('${contact.email}')">📧 Email</button>` : ''}
          </div>
        </div>
      `).join('')}

      <div class="card">
        <h2>Verification Process</h2>
        <ul>
          <li>All guides and drivers are background checked</li>
          <li>Services are regularly reviewed by tourists</li>
          <li>Contact information is verified and updated</li>
          <li>Emergency contact details are maintained</li>
          <li>Services must maintain minimum rating standards</li>
        </ul>
      </div>
    </div>
  `;
}

function renderEmergencyScreen() {
  return `
    <div class="screen">
      <div class="card">
        <h1>Emergency Services</h1>
        <p>In case of emergency, use these verified emergency services. All numbers are available 24/7.</p>
      </div>

      <div class="card">
        <h2>Quick Actions</h2>
        <div class="quick-actions">
          <button class="action-btn location" onclick="shareLocation()">
            <span class="icon">📍</span>
            <div>
              <strong>Share My Location</strong>
            </div>
          </button>
          <button class="action-btn police" onclick="makeCall('100')">
            <span class="icon">👮</span>
            <div>
              <strong>Call Police (100)</strong>
            </div>
          </button>
          <button class="action-btn medical" onclick="makeCall('108')">
            <span class="icon">🏥</span>
            <div>
              <strong>Call Medical (108)</strong>
            </div>
          </button>
          <button class="action-btn fire" onclick="makeCall('101')">
            <span class="icon">🚒</span>
            <div>
              <strong>Call Fire (101)</strong>
            </div>
          </button>
        </div>
      </div>

      <div class="card">
        <h2>Emergency Contacts</h2>
        ${contacts.emergency.map(contact => `
          <div class="emergency-contact">
            <div class="emergency-info">
              <strong>${contact.name}</strong>
              <p>${contact.description}</p>
              <div class="emergency-number">${contact.number}</div>
            </div>
            <button class="btn-emergency" onclick="makeCall('${contact.number}')">📞 Call</button>
          </div>
        `).join('')}
      </div>

      <div class="card">
        <h2>Emergency Checklist</h2>
        <p>In case of emergency:</p>
        <ul>
          <li>Stay calm and assess the situation</li>
          <li>Call the appropriate emergency number</li>
          <li>Provide your exact location</li>
          <li>Describe the emergency clearly</li>
          <li>Follow instructions from emergency services</li>
          <li>Stay on the line until help arrives</li>
          <li>If possible, share your location using the app</li>
        </ul>
      </div>

      <div class="card">
        <h2>Important Locations</h2>
        <p><strong>Police Stations:</strong></p>
        <ul>
          <li>Palakkad City Police Station</li>
          <li>NSS College Campus Security</li>
          <li>Malampuzha Police Station</li>
        </ul>
        
        <p><strong>Hospitals:</strong></p>
        <ul>
          <li>District Hospital, Palakkad</li>
          <li>NSS College Health Center</li>
          <li>Malampuzha Primary Health Center</li>
        </ul>
        
        <p><strong>Tourist Police:</strong></p>
        <ul>
          <li>Tourist Police Station, Palakkad Fort</li>
          <li>Tourist Police Station, Malampuzha Dam</li>
        </ul>
      </div>
    </div>
  `;
}

function renderCulturalEtiquetteScreen() {
  const categories = [
    { key: 'general', label: 'General', icon: '👋' },
    { key: 'temples', label: 'Temples', icon: '🛕' },
    { key: 'food', label: 'Food', icon: '🍽️' },
    { key: 'transportation', label: 'Transport', icon: '🚗' },
    { key: 'scams', label: 'Scams', icon: '⚠️' },
    { key: 'shopping', label: 'Shopping', icon: '🛍️' }
  ];

  const currentGuide = culturalGuide[etiquetteCategory];

  return `
    <div class="screen">
      <div class="card">
        <h1>Cultural Etiquette & Scams Guide</h1>
        <p>Essential dos and don'ts to help you navigate Kerala's culture respectfully and avoid common tourist scams.</p>
      </div>

      <div class="etiquette-tips">
        <h3>💡 Quick Tips</h3>
        <p>Respect local customs, dress modestly in religious places, use your right hand for eating, and always bargain politely. When in doubt, observe how locals behave and follow their lead.</p>
      </div>

      <div class="etiquette-categories">
        ${categories.map(cat => `
          <button class="etiquette-category ${etiquetteCategory === cat.key ? 'active' : ''}" 
                  onclick="etiquetteCategory = '${cat.key}'; renderApp();">
            ${cat.icon} ${cat.label}
          </button>
        `).join('')}
      </div>

      <div class="card">
        <h2>${currentGuide.title}</h2>
        <p>Follow these guidelines to show respect for Kerala's culture and avoid common tourist pitfalls.</p>
      </div>

      <div class="etiquette-content">
        <div class="etiquette-section dos">
          <h3><span class="etiquette-icon">✅</span>Dos</h3>
          <ul class="etiquette-list">
            ${currentGuide.dos.map(item => `<li>${item}</li>`).join('')}
          </ul>
        </div>

        <div class="etiquette-section donts">
          <h3><span class="etiquette-icon">❌</span>Don'ts</h3>
          <ul class="etiquette-list">
            ${currentGuide.donts.map(item => `<li>${item}</li>`).join('')}
          </ul>
        </div>
      </div>

      ${etiquetteCategory === 'scams' ? `
        <div class="scam-warning">
          <h3>⚠️ Important Warning</h3>
          <p>If you encounter any of these scams, stay calm, don't confront the scammer, and report to tourist police immediately. Keep your valuables secure and trust your instincts.</p>
        </div>

        <div class="common-scams">
          <h2>Most Common Scams in Kerala</h2>
          <p>Detailed information about specific scams tourists should be aware of:</p>
          
          ${currentGuide.commonScams.map(scam => `
            <div class="scam-item">
              <div class="scam-header">
                <span class="scam-icon">⚠️</span>
                <h3 class="scam-title">${scam.name}</h3>
              </div>
              
              <p class="scam-description">${scam.description}</p>
              
              <div class="scam-details">
                <div class="scam-detail">
                  <h4>How It Works</h4>
                  <p>${scam.howItWorks}</p>
                </div>
                
                <div class="scam-detail">
                  <h4>Warning Signs</h4>
                  <p>${scam.warningSigns}</p>
                </div>
                
                <div class="scam-detail">
                  <h4>Prevention</h4>
                  <p>${scam.prevention}</p>
                </div>
                
                <div class="scam-detail">
                  <h4>What To Do</h4>
                  <p>${scam.whatToDo}</p>
                </div>
              </div>
              
              <div class="scam-actions">
                <button class="scam-action-btn" onclick="makeCall('100')">Report to Police</button>
                <button class="scam-action-btn secondary" onclick="makeCall('1363')">Tourist Helpline</button>
              </div>
            </div>
          `).join('')}
        </div>
      ` : ''}

      <div class="card">
        <h2>Emergency Cultural Contacts</h2>
        <p>If you encounter cultural misunderstandings or need assistance:</p>
        <ul>
          <li><strong>Tourist Police:</strong> 100 (24/7 assistance)</li>
          <li><strong>Tourist Helpline:</strong> 1363 (Kerala Tourism)</li>
          <li><strong>Women Helpline:</strong> 1091 (for women travelers)</li>
          <li><strong>Local Tourism Office:</strong> Available in major cities</li>
        </ul>
      </div>

      <div class="card">
        <h2>Cultural Sensitivity Reminders</h2>
        <ul>
          <li>Kerala is a diverse state with multiple religions - respect all faiths</li>
          <li>Dress codes vary by location - temples require modest attire</li>
          <li>Photography restrictions may apply in religious places</li>
          <li>Some areas may have specific customs - ask locals for guidance</li>
          <li>Language barriers are common - patience and gestures help</li>
          <li>Environmental consciousness is important - Kerala is eco-friendly</li>
        </ul>
      </div>
    </div>
  `;
}

function renderSafetyScreen() {
  if (!isCheckedIn) {
    return `
      <div class="screen">
        <div class="card">
          <h1>Safety Check-in</h1>
          <p>Use this feature to check in during your travels. This helps ensure your safety and provides peace of mind for solo travelers.</p>
        </div>

        <div class="card">
          <h2>Check In</h2>
          <div class="form-group">
            <label>Current Location</label>
            <input type="text" id="checkin-location" placeholder="Enter your current location">
          </div>
          
          <div class="form-group">
            <label>Activity/Where are you going?</label>
            <input type="text" id="checkin-activity" placeholder="What are you doing?">
          </div>
          
          <div class="form-group">
            <label>Expected Return Time</label>
            <input type="text" id="checkin-return" placeholder="e.g., 6:00 PM">
          </div>
          
          <div class="form-group">
            <label>Emergency Contact Number</label>
            <input type="text" id="checkin-contact" placeholder="+91 98765 43210">
          </div>
          
          <div class="form-group">
            <label>Additional Notes</label>
            <textarea id="checkin-notes" rows="3" placeholder="Any additional information..."></textarea>
          </div>

          <button class="btn-primary btn-large" onclick="handleCheckin()">✅ Check In</button>
        </div>

        <div class="card">
          <h2>Safety Tips for Solo Travelers</h2>
          <ul>
            <li>Always inform someone about your travel plans</li>
            <li>Keep emergency contacts updated</li>
            <li>Use verified transportation services</li>
            <li>Avoid isolated areas, especially at night</li>
            <li>Keep copies of important documents</li>
            <li>Trust your instincts - if something feels wrong, leave</li>
            <li>Stay connected with family/friends regularly</li>
            <li>Learn basic local phrases for emergencies</li>
          </ul>
        </div>

        <div class="card">
          <h2>How It Works</h2>
          <ol>
            <li>Check in when you start your activity</li>
            <li>Provide your location and expected return time</li>
            <li>Add an emergency contact number</li>
            <li>Check out when you're safe</li>
            <li>Use emergency alert if you need immediate help</li>
          </ol>
          <p><strong>Your check-in data is stored locally on your device for privacy.</strong></p>
        </div>
      </div>
    `;
  } else {
    return `
      <div class="screen">
        <div class="card">
          <h1>Safety Check-in</h1>
          <p>Use this feature to check in during your travels. This helps ensure your safety and provides peace of mind for solo travelers.</p>
        </div>

        <div class="card checkin-status">
          <div class="checkin-icon">🛡️</div>
          <h2>Currently Checked In</h2>
          <div class="checkin-details">
            <p><strong>Location:</strong> ${lastCheckin?.location}</p>
            <p><strong>Activity:</strong> ${lastCheckin?.activity}</p>
            <p><strong>Expected Return:</strong> ${lastCheckin?.expectedReturn}</p>
            <p><strong>Check-in Time:</strong> ${formatTime(lastCheckin?.timestamp)}</p>
          </div>
          
          <div class="checkin-actions">
            <button class="btn-warning" onclick="handleCheckout()">🚪 Check Out</button>
            <button class="btn-emergency" onclick="sendEmergencyAlert()">🚨 Emergency Alert</button>
          </div>
        </div>

        <div class="card">
          <h2>Safety Tips for Solo Travelers</h2>
          <ul>
            <li>Always inform someone about your travel plans</li>
            <li>Keep emergency contacts updated</li>
            <li>Use verified transportation services</li>
            <li>Avoid isolated areas, especially at night</li>
            <li>Keep copies of important documents</li>
            <li>Trust your instincts - if something feels wrong, leave</li>
            <li>Stay connected with family/friends regularly</li>
            <li>Learn basic local phrases for emergencies</li>
          </ul>
        </div>
      </div>
    `;
  }
}

function renderApp() {
  const app = document.getElementById('app');
  if (!app) return;

  let content = '';
  switch (currentScreen) {
    case 'phrasebook':
      content = renderPhrasebookScreen();
      break;
    case 'directory':
      content = renderDirectoryScreen();
      break;
    case 'emergency':
      content = renderEmergencyScreen();
      break;
    case 'safety':
      content = renderSafetyScreen();
      break;
    case 'etiquette':
      content = renderCulturalEtiquetteScreen();
      break;
    default:
      content = renderHomeScreen();
  }

  app.innerHTML = `
    <header class="app-header">
      <div class="logo-container">
        <div class="logo-shield">
          <svg width="40" height="40" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M12 2L13.09 8.26L20 9L13.09 15.74L12 22L10.91 15.74L4 9L10.91 8.26L12 2Z" fill="white"/>
            <path d="M9 12L11 14L15 10" stroke="#1B5E20" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </div>
        <div class="logo-text">
          <h1>GoSafe</h1>
          <p>Kerala Tourist Safety Companion</p>
        </div>
      </div>
    </header>
    
    <main class="app-main">
      ${content}
    </main>
    
    <nav class="bottom-nav">
      <button class="nav-btn ${currentScreen === 'home' ? 'active' : ''}" onclick="showScreen('home')">
        <span class="nav-icon">🏠</span>
        <span class="nav-label">Home</span>
      </button>
      <button class="nav-btn ${currentScreen === 'phrasebook' ? 'active' : ''}" onclick="showScreen('phrasebook')">
        <span class="nav-icon">📖</span>
        <span class="nav-label">Phrases</span>
      </button>
      <button class="nav-btn ${currentScreen === 'directory' ? 'active' : ''}" onclick="showScreen('directory')">
        <span class="nav-icon">👥</span>
        <span class="nav-label">Services</span>
      </button>
      <button class="nav-btn ${currentScreen === 'etiquette' ? 'active' : ''}" onclick="showScreen('etiquette')">
        <span class="nav-icon">🎭</span>
        <span class="nav-label">Etiquette</span>
      </button>
      <button class="nav-btn ${currentScreen === 'emergency' ? 'active' : ''}" onclick="showScreen('emergency')">
        <span class="nav-icon">📞</span>
        <span class="nav-label">Emergency</span>
      </button>
      <button class="nav-btn ${currentScreen === 'safety' ? 'active' : ''}" onclick="showScreen('safety')">
        <span class="nav-icon">🛡️</span>
        <span class="nav-label">Safety</span>
      </button>
    </nav>
  `;
}

// Initialize App
function initApp() {
  loadCheckinData();
  
  // Load saved preferences
  isDarkMode = localStorage.getItem('darkMode') === 'true';
  isHighContrast = localStorage.getItem('highContrast') === 'true';
  isLargeText = localStorage.getItem('largeText') === 'true';
  
  // Apply saved preferences
  if (isDarkMode) document.body.classList.add('dark-mode');
  if (isHighContrast) document.body.classList.add('high-contrast');
  if (isLargeText) document.body.classList.add('large-text');
  
  // Initialize voice recognition
  initVoiceRecognition();
  
  // Set up online/offline listeners
  window.addEventListener('online', updateOnlineStatus);
  window.addEventListener('offline', updateOnlineStatus);
  updateOnlineStatus();
  
  // Fetch weather data if location is available
  if (userLocation) {
    fetchWeatherData();
  }
  
  renderApp();
}

// Start the app when page loads
document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>